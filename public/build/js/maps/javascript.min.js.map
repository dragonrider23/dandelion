{"version":3,"sources":["admin.js","catManage.js","cheestoGetDate.js","login.js","logs.js","mail.js","permissions.js","presence.js","reset.js","settings.js","userManager.js","userManagerForms.js"],"names":["adminAction","editSlogan","current","newSlogan","window","prompt","this","performAction","backupDB","saveDefaultTheme","newTheme","$","val","saveCheesto","cheesto","saveApiSetting","pAPI","action","data","post","encodeURIComponent","done","msg","alert","CategoryManage","currentID","currentSelection","addLog","grabNextLevel","parentID","container","pid","value","level","split","splice","length","ajax","type","url","pastSelections","JSON","stringify","async","html","i","createNew","catString","getCatString","message","newCatDesc","addNew","catDesc","parent","json","editCat","cid","elt","editString","text","editedCat","deleteCat","myCatString","confirm","substring","giveTime","newStatus","opener","rtime","ver","presence","version","sendNewStatus","close","setDateTime","timeAdd","currentdate","Date","minutes","getMinutes","hours","getHours","datetime","getMonth","slice","getDate","getFullYear","document","ready","datetimepicker","timeFormat","controlType","stepMinute","attemptLogin","user","pass","remember","prop","response","location","assign","check","e","keyCode","getCookie","name","re","RegExp","exec","cookie","unescape","username","css","focus","showDialog","dialog","modal","width","show","effect","duration","hide","buttons","Ok","filt","refreshc","datepicker","change","on","target","closest","stopImmediatePropagation","tinymce","init","browser_spellcheck","refreshFun","runFirst","refreshLog","startrefresh","setInterval","stoprefresh","clearInterval","clearfilter","dataType","reload","view","makeLogView","fail","jqXHR","readyState","status","empty","append","showFilterMessage","pageControls","metadata","displayLogs","clearForm","div","attr","offset","prevPage","limit","logSize","nextPage","key","hasOwnProperty","log","creator","realname","title","entry","datec","timec","edited","cat","canEdit","logid","pagentation","pageOffset","scrollTo","addFun","showaddinputs","reset","height","Add Log","addlog","Cancel","forced_root_block","resize","menubar","toolbar","plugins","fadeOut","body","decodeURIComponent","fadeIn","setTimeout","editFun","showeditinputs","log_info","linfo","Save Edit","editlogs","grabedit","id","editedtitle","editedlog","searchFun","searchlog","keyword","dateSearch","kw","date","filter","mail","showFolder","areUnread","getJSON","count","folderName","getAllMail","getTrashCan","showMailList","trash","parsed","mailItems","table","addClass","mailItem","subject","dateSent","isItRead","viewMail","mid","timeSent","replyToMail","selection","getSelectedMailIds","fromUser","showWriteDialog","writeMailDialog","users","each","label","userid","push","autocomplete","minLength","source","event","ui","item","select","_renderItem","ul","appendTo","Send Mail","sendMail","mailPiece","to","parse","deleteMail","selected","permenant","selectedMail","permissions","allPermissions","createlog","editlog","viewlog","addcat","editcat","deletecat","adduser","edituser","deleteuser","addgroup","editgroup","deletegroup","viewcheesto","updatecheesto","admin","currentPermissions","getList","get","group","role","getPermissions","gid","groupid","showPermissions","drawGrid","savePermissions","newPermissions","getGrid","newPermissionsJson","rights","checkGrid","permission","changed","newGrid","theID","is","goBack","Create Group","sendNew","deleteGroup","delGroup","resizable","Delete Group","object","getID","theGrid","preventDefault","timeoutId","firstgen","checkstat","generateView","clearTimeout","dataObj","updateTableOnly","appendable","makeStatusSelect","tableView","userStatusesDiv","makeTableMini","makeTableFull","statusSelectDiv","statusSelect","setStatus","key2","statusOptions","tableHead","classm","returntime","statusInfo","color","symbol","popOutButton","dmodified","open","popOut","stat","rt","showHideP","api","resetPassword","pw1","pw2","pw","getApiKey","generateKey","showResetPasswordForm","Reset","saveLogLimit","saveTheme","theme","userManager","currentuid","getUsersRights","loadCommandList","loadUserList","errorcode","commands","prepend","displayUserList","userdata","userTable","header","datecreated","firsttime","uid","uiforms","add","password","fullname","console","edit","delete","pass1","pass2","cxeesto","revokeKey","rightsList","roleRow","roleCell","showDialogBox","buttonText1","userinfo","themeList","themeRow","themeCell","select1","key1","selected1","buttonText2","statusRow","statusCell","func","customize","dialog_buttons"],"mappings":"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","file":"javascript.min.js","sourcesContent":["/* global $, window, alert */\n/* exported adminAction */\n\n\"use strict\"; // jshint ignore:line\n\nvar adminAction =\n{\n\teditSlogan: function(current) {\n\t\tvar newSlogan = window.prompt('Website Slogan', current);\n\n\t\tif (newSlogan !== '' && newSlogan !== null)\n            this.performAction(\"saveSlogan\", newSlogan);\n\t},\n\n\tbackupDB: function() {\n        this.performAction(\"backupDB\", null);\n\t},\n\n\tsaveDefaultTheme: function() {\n        var newTheme = $(\"#userTheme\").val();\n        this.performAction(\"saveDefaultTheme\", newTheme);\n\t},\n\n\tsaveCheesto: function() {\n        var cheesto = $(\"#cheesto_enabled\").val();\n        this.performAction(\"saveCheesto\", cheesto);\n\t},\n\n\tsaveApiSetting: function() {\n\t    var pAPI = $(\"#api_enabled\").val();\n\t    this.performAction(\"savePAPI\", pAPI);\n\t},\n\n\tperformAction: function(action, data) {\n        $.post(\"api/i/admin/\"+action, { data: encodeURIComponent(data) }, null, \"json\")\n            .done(function( msg ) {\n                alert(msg.data);\n            });\n\t}\n};\n","/* global $, window, alert */\n\n\"use strict\"; // jshint ignore:line\n\nvar CategoryManage = {\n\tcurrentID: -1,\n\tcurrentSelection: [],\n\taddLog: false,\n\n\tgrabNextLevel: function(parentID, container) {\n\t    var pid;\n\t\tif (parentID.value) {\n\t\t\tpid = parentID.value;\n\t\t} else {\n\t\t\tpid = parentID;\n\t\t}\n\n\t\tcontainer = (this.addLog) ? '#catSpace' : '#categorySelects';\n\n\t\tvar level = pid.split(':');\n\n\t\tif (this.currentSelection[level[1]]) {\n\t\t\tthis.currentSelection.splice(level[1]);\n\t\t}\n\n\t\tthis.currentSelection[level[1]] = pid;\n\n        if (this.currentSelection.length === 0) {\n\t\t\tthis.currentSelection[0] = '0:0';\n\t\t}\n\n\t\t$.ajax({\n            type: \"POST\",\n            url: \"lib/categories\",\n            data: { action: \"grabcats\", pastSelections: JSON.stringify(this.currentSelection)},\n            async: false\n        })\n            .done(function( html ) {\n                if (typeof $(\"#categorySelects\")[0] !== 'undefined') {\n                    $(\"#categorySelects\").html(\"\");\n                    $(container).html( html );\n                    CategoryManage.currentID = pid;\n\n                    for (var i=1; i<CategoryManage.currentSelection.length; i++) {\n                        $(\"#level\"+i).val( CategoryManage.currentSelection[i] );\n                    }\n                }\n            });\n\t},\n\n\tcreateNew: function() {\n\t\tvar catString = this.getCatString();\n\t\tvar message = 'Add new category\\n\\n';\n\n\t\tif (this.currentSelection.length == 1) {\n\t\t\tmessage = 'Create new root category:';\n\t\t\tcatString = '';\n\t\t}\n\n\t\twhile (true) {\n\t\t\tvar newCatDesc = window.prompt(message+catString);\n\n\t\t\tif (newCatDesc === '') {\n\t\t\t\talert('Please enter a category description');\n\t\t\t}\n\t\t\telse if (newCatDesc === null) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.addNew(encodeURIComponent(newCatDesc));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t},\n\n\taddNew: function(catDesc) {\n\t\tvar newCatDesc = catDesc;\n\t\tvar parent = this.currentSelection[this.currentSelection.length-1].split(':');\n\t\tparent = parent[0];\n\n\t\t$.post(\"api/i/categories/add\", { parentID: parent, catDesc: newCatDesc }, null, 'json')\n            .done(function( json ) {\n                alert(json.data);\n\t\t\t\tCategoryManage.grabNextLevel(CategoryManage.currentSelection[CategoryManage.currentSelection.length-2]);\n            });\n\t},\n\n\teditCat: function() {\n\t\tvar cid = this.currentSelection[this.currentSelection.length-1].split(':');\n\n\t\tvar elt = $(\"#level\"+cid[1]+\" option:selected\");\n\n\t\tif (typeof elt.val() !== 'undefined') {\n\t\t\tvar editString = elt.text();\n            var editedCat = window.prompt(\"Edit Category Description:\",editString);\n\n            if (editedCat !== null && editedCat !== '') {\n                $.post(\"api/i/categories/edit\", { cid: cid[0], catDesc: encodeURIComponent(editedCat) }, null, 'json')\n                    .done(function( json ) {\n                        alert(json.data);\n                        CategoryManage.grabNextLevel(CategoryManage.currentSelection[CategoryManage.currentSelection.length-2]);\n                    });\n            }\n\t\t}\n\t},\n\n\tdeleteCat: function() {\n\t\tvar myCatString = this.getCatString();\n\t\tvar cid = this.currentSelection[this.currentSelection.length-1].split(':');\n\t\tcid = cid[0];\n\n\t\tif (!window.confirm('Delete '+ myCatString +'?\\n\\nWarning: All child categories will be moved up one level!')) {\n\t\t\treturn false;\n\t\t}\n\n        $.post(\"api/i/categories/delete\", { cid: cid }, null ,'json')\n            .done(function( json ) {\n                alert(json.data);\n                CategoryManage.grabNextLevel(CategoryManage.currentSelection[CategoryManage.currentSelection.length-2]);\n            });\n\t},\n\n\tgetCatString: function() {\n\t\tvar catString = '';\n\n\t\tfor (var i=0; i<this.currentSelection.length; i++) {\n\t\t\tif ($(\"#level\"+(i+1))) {\n\t\t\t\tvar elt = $(\"#level\"+(i+1)+\" option:selected\");\n\n\t\t\t\tif (elt.text() != 'Select:') {\n\t\t\t\t\tcatString += elt.text() + ':';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (catString.length > 0) {\n\t\t\treturn catString.substring(0, catString.length - 1);\n\t\t}\n\t\telse {\n\t\t\treturn false;\n\t\t}\n\t},\n};\n","/* global $, document, window */\n/* exported giveTime, setDateTime */\n\n\"use strict\"; // jshint ignore:line\n\n$(document).ready(function() {\n    $('#datepick').datetimepicker({\n            timeFormat: \"HH:mm\",\n            controlType: 'select',\n            stepMinute: 10,\n        });\n});\n\nfunction giveTime() {\n    var newStatus = window.opener.newStatus,\n\t\trtime = $(\"#datepick\").val(),\n\t\tver = window.opener.presence.version,\n\t\tmessage = $(\"#messagetext\").val();\n\t\t\n    message = encodeURIComponent(message);\n    \n    window.opener.presence.sendNewStatus(newStatus, rtime, ver, message);\n    window.close();\n}\n\nfunction setDateTime(timeAdd) {\n    var currentdate = new Date();\n    \n    var minutes = currentdate.getMinutes()+(timeAdd % 60);\n    var hours = currentdate.getHours()+((timeAdd-(timeAdd % 60))/60);\n    \n    if (minutes > 59) {\n        minutes = minutes - 60;\n        hours++;\n    }\n    \n    \n    var datetime = ('0'  + (currentdate.getMonth()+1)).slice(-2) + \"/\" +\n                   ('0'  + currentdate.getDate()).slice(-2) + \"/\" +\n                   currentdate.getFullYear() + \" \" +\n                   ('0'  + hours).slice(-2) + \":\" +\n                   ('0'  + minutes).slice(-2);\n                   \n    $(\"#datepick\").val( datetime );\n}","/* global $, document, alert, location, unescape */\n\n\"use strict\"; // jshint ignore:line\n\nfunction attemptLogin() {\n    var user = $('#username').val();\n    var pass = $('#password').val();\n    var remember = $('#rememberMe').prop('checked');\n\n    if (user === '' || pass === '') {\n        return false;\n    }\n\n    $.post(\"/login\", { user: user, pass: pass, remember: remember }, null, 'json')\n        .done(function( response ) {\n            if (response != '1' && response != '2') {\n                alert(response);\n                return;\n            }\n\n            if (response == '2') {\n                location.assign('/reset');\n            } else if (response == '1') {\n                location.assign('/');\n            }\n        });\n}\n\nfunction check(e) {\n    if (e.keyCode == 13) {\n        attemptLogin();\n    }\n}\n\nfunction getCookie(name) {\n    var re = new RegExp(name + \"=([^;]+)\");\n    var value = re.exec(document.cookie);\n    return (value !== null) ? unescape(value[1]) : null;\n}\n\n(function() {\n    var username = getCookie('dan_username');\n\n    if (username !== null) {\n        $('#remember').css('display', 'none');\n        $('#username').val(username);\n        $('#password').focus();\n    } else {\n        $('#username').focus();\n    }\n})();\n","/* global CategoryManage, $, document, window, setInterval, setTimeout, clearInterval, alert, tinymce */\n\n\"use strict\"; // jshint ignore:line\n\nvar filt = false,\n    refreshc;\n\n$(document).ready(function() {\n    $( \"#datesearch\" ).datepicker();\n    $( \"#datesearch\" ).change(function() {\n        $( \"#datesearch\" ).datepicker( \"option\", \"dateFormat\", \"yy-mm-dd\" );\n        });\n\n    $(\"#add_edit\").css(\"display\", \"none\");\n});\n\n$(document).on(\"focusin\", function(e) {\n\tif ($(e.target).closest(\".mce-window\").length) {\n\t\te.stopImmediatePropagation();\n\t}\n});\n\ntinymce.init({\n    browser_spellcheck: true\n});\n\nvar refreshFun =\n{\n    runFirst: function() {\n        refreshFun.refreshLog();\n        CategoryManage.grabNextLevel('0:0');\n        this.startrefresh();\n    },\n\n    startrefresh: function() {\n        refreshc = setInterval(function(){ refreshFun.refreshLog(); }, 60000);\n    },\n\n    stoprefresh: function() {\n        clearInterval(refreshc);\n    },\n\n    refreshLog: function(clearfilter) {\n        if (clearfilter) {\n            filt=false;\n            $(\"#searchterm\").val(\"Keyword\");\n            $(\"#datesearch\").val(\"Date\");\n            refreshFun.startrefresh();\n        }\n\n        if (!filt) {\n            $.ajax({\n                type: \"POST\",\n                url: \"api/i/logs/read\",\n                async: false,\n                dataType: \"json\"\n            })\n                .done(function( html ) {\n                    if (html === \"\") {\n                        window.location.reload(true);\n                    }\n                    view.makeLogView(html.data);\n                })\n\n                .fail(function( jqXHR ) {\n                    if ( typeof jqXHR !== 'undefined' && jqXHR.readyState===4 && jqXHR.status===404)\n                    {\n                        $(\"#refreshed\").html(\"An error has occured. Please try logging out and back in.\");\n                    }\n                });\n        }\n    }\n}; // refreshFun\n\nvar view = {\n    makeLogView:function(data) {\n        $('#refreshed').empty();\n        if (filt) { $('#refreshed').append(view.showFilterMessage()); }\n        $('#refreshed').append(view.pageControls(data.metadata));\n        $('#refreshed').append(view.displayLogs(data));\n        $('#refreshed').append(view.pageControls(data.metadata));\n    },\n\n    showFilterMessage: function() {\n        var clearForm = $('<form/>');\n        // jshint multistr:true\n        var html = '<h3>You are viewing filtered results\\\n                    <button type=\"button\" onClick=\"refreshFun.refreshLog(true)\">Clear Results</button></h3>';\n       clearForm.append(html);\n       return clearForm;\n    },\n\n    pageControls: function(data) {\n        if (filt) {\n            return false;\n        }\n\n        var div = $('<div/>').attr('class', 'pagination');\n\n        var html = '<form method=\"post\">';\n        if (data.offset > 0) {\n            var prevPage = data.offset-data.limit;\n            html += '<input type=\"button\" value=\"Previous '+data.limit+'\" onClick=\"view.pagentation('+prevPage+');\" class=\"flle\">';\n        }\n        if (data.offset+data.limit < data.logSize) {\n            var nextPage = data.offset+data.limit;\n            html += '<input type=\"button\" value=\"Next '+data.limit+'\" onClick=\"view.pagentation('+ nextPage +');\" class=\"flri\">';\n        }\n        html += '</form></div>';\n        div.append(html);\n        return div;\n    },\n\n    displayLogs: function(data) {\n        var div = $('<div/>').attr('id', 'refreshed_core');\n\n        for (var key in data) {\n            if (!data.hasOwnProperty(key) || key == 'metadata')\n                continue;\n\n            var log = data[key];\n\n            var creator = log.realname;\n            if (creator === '') {\n                creator = 'Unknown User';\n            }\n\n            // Display each log entry\n            // jshint multistr:true\n            var html = '<form method=\"post\">\\\n                        <div class=\"logentry\">\\\n                        <h2>' + log.title + '</h2>\\\n                        <p class=\"entry\">' + log.entry + '</p>\\\n                        <p class=\"entrymeta\">Created by ' + creator + ' on ' + log.datec + ' @ ' + log.timec + ' ';\n\n            if (log.edited == \"1\") { html += '(Edited)'; }\n\n            html += '<br>Categorized as ' + log.cat + '\\\n                     <br><a href=\"#\" onClick=\"searchFun.filter(\\'' + log.cat + '\\');\">Learn more about this system...</a>';\n\n            if (log.canEdit) { html += '<input type=\"button\" value=\"Edit\" onClick=\"editFun.grabedit(' + log.logid + ');\" class=\"flri\">'; }\n\n            html += '</p></div></form>';\n\n            div.append(html);\n        }\n        return div;\n    },\n\n    pagentation: function(pageOffset) {\n        $.post(\"api/i/logs/read\", { offset: pageOffset }, null, \"json\")\n            .done(function( html ) {\n                view.makeLogView(html.data);\n\n                if (pageOffset <= 0) {\n                    refreshFun.refreshLog();\n                    refreshFun.startrefresh();\n                } else {\n                    refreshFun.stoprefresh();\n                }\n\n                window.scrollTo(0,0);\n            })\n\n            .fail(function( jqXHR ) {\n                if ( typeof jqXHR !== 'undefined' && jqXHR.readyState===4 && jqXHR.status===404) {\n                    $(\"#refreshed\").html(\"An error has occured. Please try logging out and back in.\");\n                }\n            });\n    }\n}; // View\n\nvar addFun =\n{\n    showaddinputs: function() {\n        $(\"#add_edit_form\")[0].reset();\n        $(\"textarea#logEntry\").html(\"\");\n\n        $( \"#add_edit\" ).dialog({\n\t\t\theight: 575,\n\t\t\twidth: 800,\n\t\t\tmodal: true,\n\t\t\tshow: {\n\t\t\t\teffect: \"fade\",\n\t\t\t\tduration: 500\n\t\t\t},\n\t\t\thide: {\n\t\t\t\teffect: \"fade\",\n\t\t\t\tduration: 500\n\t\t\t},\n\t\t\tbuttons: {\n\t\t\t\t\"Add Log\": function() {\n\t\t\t\t\taddFun.addlog();\n\t\t\t\t},\n\t\t\t\tCancel: function() {\n\t\t\t\t\t$( this ).dialog( \"close\" );\n\t\t\t\t\tCategoryManage.addLog = false;\n\t\t\t\t\tCategoryManage.grabNextLevel('0:0');\n\t\t\t\t}\n\t\t\t}\n        });\n\n        $(\"textarea#logEntry\").tinymce({\n            browser_spellcheck: true,\n\t\t\tforced_root_block: false,\n\t\t\tresize: false,\n\t\t\tmenubar: \"edit format view insert tools\",\n\t\t\ttoolbar: \"undo redo | styleselect | bold italic underline | alignleft aligncenter alignright | bullist numlist | link | forecolor\",\n\t\t\tplugins: [\n\t\t\t\t\"autolink link lists hr anchor pagebreak\",\n\t\t\t\t\"searchreplace wordcount code insertdatetime\",\n\t\t\t\t\"template paste textcolor\"\n\t\t\t\t]\n        });\n\n        CategoryManage.addLog = true;\n        CategoryManage.grabNextLevel('0:0');\n    },\n\n    addlog: function() {\n        var title = $(\"input#logTitle\").val();\n        title = encodeURIComponent(title);\n        var entry = $(\"textarea#logEntry\").val();\n        entry = encodeURIComponent(entry);\n        var cat = CategoryManage.getCatString();\n\n\t\tif (title !== \"\" && entry !== \"\" && cat !== \"\") {\n\t\t\t$( \"#add_edit\" ).dialog( \"close\" );\n\t\t\t$(\"#messages\").fadeOut();\n\n\t\t\t$.post(\"api/i/logs/create\", { title: title, body: entry, cat: cat }, null, 'json')\n\t\t\t\t.done(function( html ) {\n\t\t\t\t\trefreshFun.refreshLog();\n\t\t\t\t\tCategoryManage.addLog = false;\n\t\t\t\t\tCategoryManage.grabNextLevel('0:0');\n\t\t\t\t\tshowDialog(html.data);\n\t\t\t\t});\n        }\n        else {\n\t\t\t$(\"input#logTitle\").val( decodeURIComponent(title) );\n\t\t\t$(\"textarea#logEntry\").html( decodeURIComponent(entry) );\n\t\t\t$(\"#messages\").html('<span class=\"bad\">Log entries must have a title, category, and entry text.</span>').fadeIn();\n\t\t\tCategoryManage.addLog = true;\n\t\t\tCategoryManage.grabNextLevel('0:0');\n\t\t\tsetTimeout(function() { $(\"#messages\").fadeOut(); }, 10000);\n        }\n    },\n}; //addFun\n\nvar editFun =\n{\n    showeditinputs: function(log_info) {\n        var linfo = log_info.data;\n\n        $(\"input#logTitle\").val( linfo.title );\n        $(\"textarea#logEntry\").val( linfo.entry );\n        $(\"#catSpace\").text( linfo.cat );\n\n        $( \"#add_edit\" ).dialog({\n\t\t\theight: 575,\n\t\t\twidth: 800,\n\t\t\tmodal: true,\n\t\t\tshow: {\n\t\t\t\teffect: \"fade\",\n\t\t\t\tduration: 500\n\t\t\t},\n\t\t\thide: {\n\t\t\t\teffect: \"fade\",\n\t\t\t\tduration: 500\n\t\t\t},\n\t\t\tbuttons: {\n\t\t\t\t\"Save Edit\": function() {\n\t\t\t\t\teditFun.editlogs(linfo.logid);\n\t\t\t\t},\n\t\t\t\tCancel: function() {\n\t\t\t\t\t$( this ).dialog( \"close\" );\n\t\t\t\t}\n\t\t\t}\n        });\n\n        $(\"textarea#logEntry\").tinymce({\n            browser_spellcheck: true,\n\t\t\tforced_root_block: false,\n\t\t\tresize: false,\n\t\t\tmenubar: \"edit format view insert tools\",\n\t\t\ttoolbar: \"undo redo | styleselect | bold italic underline | alignleft aligncenter alignright | bullist numlist | link | forecolor\",\n\t\t\tplugins: [\n\t\t\t\t\"autolink link lists hr anchor pagebreak\",\n\t\t\t\t\"searchreplace wordcount code insertdatetime\",\n\t\t\t\t\"template paste textcolor\"\n\t\t\t\t]\n        });\n    },\n\n    /* This function is called when a user clicks edit\n     * It grabs the information about the log entry they\n     * want to edit then calls showeditinputs(); to display\n     * the fields.\n     */\n    grabedit: function(logid) {\n        $.post(\"api/i/logs/readone\", { logid: logid }, null, 'json')\n            .done( editFun.showeditinputs );\n    },\n\n    //Sends the finished edited log to a PHP file for processing\n    editlogs: function(id) {\n        var editedtitle = $(\"input#logTitle\").val();\n        editedtitle = encodeURIComponent(editedtitle);\n        var editedlog = $(\"textarea#logEntry\").val();\n        editedlog = encodeURIComponent(editedlog);\n\n        if (editedtitle !== \"\" && editedlog !== \"\") {\n\t\t\t$( \"#add_edit\" ).dialog( \"close\" );\n\t\t\t$(\"#messages\").fadeOut();\n\n\t\t\t$.post(\"api/i/logs/edit\", { logid: id, title: editedtitle, body: editedlog }, null, 'json')\n\t\t\t\t.done(function( html ) {\n\t\t\t\trefreshFun.refreshLog();\n\t\t\t\tshowDialog(html.data);\n\t\t\t});\n\t\t}\n\n        else {\n\t\t\t$(\"#messages\").html('<span class=\"bad\">Log entries must have a title, category, and entry text.</span>').fadeIn();\n\t\t\tsetTimeout(function() { $(\"#messages\").fadeOut(); }, 10000);\n        }\n    },\n}; //editFun\n\nfunction showDialog( html ) {\n\t$( \"#dialog\" ).html( \"<p>\"+html+\"</p>\" );\n\t$( \"#dialog\" ).dialog({\n\t\tmodal: true,\n\t\twidth: 400,\n\t\tshow: {\n\t\t\teffect: \"fade\",\n\t\t\tduration: 500\n\t\t},\n\t\thide: {\n\t\t\teffect: \"fade\",\n\t\t\tduration: 500\n\t\t},\n\t\tbuttons: {\n\t\t\tOk: function() {\n\t\t\t\t$( this ).dialog( \"close\" );\n\t\t\t}\n\t\t}\n\t});\n}\n\nvar searchFun =\n{\n    // Checks if enter key was pressed, if so search\n    check: function(e) {\n        if (e.keyCode == 13) {\n            searchFun.searchlog();\n        }\n    },\n\n    // Search for keyword or datestamp\n    searchlog :function() {\n        var keyword = $(\"input#searchterm\").val();\n        var dateSearch   = $(\"input#datesearch\").val();\n        if (keyword === 'Keyword') { keyword = ''; }\n        if (dateSearch === 'Date') { dateSearch = ''; }\n\n        keyword = encodeURIComponent(keyword);\n\n        $.post(\"api/i/logs/search\", { kw: keyword, date: dateSearch })\n            .done(function( html ) {\n                filt=true;\n                refreshFun.stoprefresh();\n                view.makeLogView(html.data);\n            });\n    },\n\n    // Search for a category of logs\n    filter: function(cat) {\n        if (cat === '') { cat = CategoryManage.getCatString(); }\n\n        if (cat)\n        {\n            $.post(\"api/i/logs/filter\", { filter: cat }, null, 'json')\n                .done(function( html ) {\n                    filt=true;\n                    refreshFun.stoprefresh();\n                    view.makeLogView(html.data);\n                })\n\n                .fail(function( jqXHR ) {\n                    if ( typeof jqXHR !== 'undefined' && jqXHR.readyState===4 && jqXHR.status===404)\n                    {\n                        $(\"#refreshed\").html(\"An error has occured. Please try logging out and back in.\");\n                    }\n                });\n        }\n        else {\n            alert(\"Please select a valid filter.\");\n        }\n    },\n};\n","/* global $, document, setTimeout, alert, confirm */\n/* jshint multistr: true */\n\n\"use strict\"; // jshint ignore:line\n\n$(document).ready(function() {\n    $(\"#writeMail\").css(\"display\", \"none\");\n    mail.showFolder();\n});\n\n$(document).on(\"focusin\", function(e) {\n    if ($(e.target).closest(\".mce-window\").length) {\n        e.stopImmediatePropagation();\n    }\n});\n\nvar mail = {\n        areUnread: function() {\n            $.getJSON(\"api/i/mail/mailCount\", function(data) {\n                if (data.data.count > 0) {\n                    $(\"#mailicon\").attr(\"src\", \"static/images/mail.png\");\n                    $(\"#mailicon\").attr(\"alt\", \"You have mail\");\n                    $(\"#mailicon\").attr(\"title\", data.data.count);\n                }\n            });\n\n            setTimeout(function(){ mail.areUnread(); }, 10000);\n        },\n        \n        showFolder: function() {\n            var folderName = $(\"#folder\").val();\n            switch (folderName) {\n                case \"inbox\":\n                    this.getAllMail();\n                    break;\n                    \n                case \"trash\":\n                    this.getTrashCan();\n                    break;\n            }\n        },\n\n        getAllMail: function() {\n            $.getJSON(\"api/i/mail/getAllMail\",\n                    function(data){ mail.showMailList(data.data); });\n        },\n        \n        getTrashCan: function() {\n            $.getJSON(\"api/i/mail/getAllMail\", {\"trash\": \"true\"},\n                    function(data){ mail.showMailList(data.data); });\n        },\n\n        showMailList: function(parsed) {\n            var mailItems = parsed.length;\n\n            $('#mailList').html('');\n            var table = $('<table/>').addClass(\"mailboxCSS\");\n\n            table.append('<tr>\\\n                    <th width=\"2%\">&nbsp;</th>\\\n                    <th width=\"15%\">From</th>\\\n                    <th width=\"63%\">Subject</th>\\\n                    <th width=\"20%\">Date</th>\\\n            </tr>');\n\n            for(var i=0; i<mailItems; i++){\n                var mailItem = parsed[i];\n\n                var html = '<tr>\\\n                    <td><input type=\"checkbox\" id=\"check'+i+'\" value='+mailItem.id+'></td>\\\n                    <td>'+mailItem.realname+'</td>\\\n                    <td><a href=\"#\" onClick=\"mail.viewMail('+mailItem.id+');\">'+mailItem.subject+'</a></td>\\\n                    <td>'+mailItem.dateSent+'</td>\\\n                    </tr>';\n\n                if (mailItem.isItRead == \"0\") {\n                    table.append($(html).addClass('unread'));\n                }\n                else {\n                    table.append(html);\n                }\n            }\n\n            $('#mailList').append(table);\n        },\n\n        viewMail: function(id) {\n            $.getJSON(\"api/i/mail/read\", {mid: id}, function(data) {\n                data = data.data;\n                mail.showFolder();\n\n                var html = '<h2>'+data[0].subject+'</h2>\\\n                To: You<br>\\\n                From: '+data[0].realname+'<br>\\\n                Sent: '+data[0].dateSent+' '+data[0].timeSent+'<br>\\\n                <br>'+data[0].body;\n\n                $( \"#mailDialog\" ).html( html );\n                $( \"#mailDialog\" ).dialog({\n                    modal: true,\n                    width: 400,\n                    show: {\n                        effect: \"fade\",\n                        duration: 500\n                    },\n                    hide: {\n                        effect: \"fade\",\n                        duration: 500\n                    },\n                    buttons: {\n                        Ok: function() {\n                            $( this ).dialog( \"close\" );\n                            $( \"#mailDialog\" ).html( '' );\n                        }\n                    }\n                });\n            });\n        },\n\n        replyToMail: function() {\n            var selection = this.getSelectedMailIds();\n            if (selection.length == 1) {\n                $.getJSON(\"api/i/mail/read\", {mid: selection[0]}, function(data) {\n                    data = data.data;\n                    $(\"#mailForm\")[0].reset();\n                    $(\"textarea#mailBody\").html(data[0].body);\n                    $(\"#mailSubject\").val(\"RE: \" + data[0].subject);\n                    $(\"#toUsersId\").val(data[0].fromUser);\n                    $(\"#toUsers\").val(data[0].realname);\n                    $(\"#toUsers\").prop(\"readonly\", true);\n                    \n                    mail.showWriteDialog();\n                });\n            }\n        },\n\n        writeMailDialog: function() {\n            $.getJSON(\"api/i/mail/getUserList\", function(data) {\n                data = data.data;\n                $(\"#mailForm\")[0].reset();\n                $(\"#toUsers\").prop(\"readonly\", false);\n                $(\"textarea#mailBody\").html(\"\");\n                $(\"#toUsersId\").val(\"\");\n\n                mail.showWriteDialog();\n\n                var users = [];\n\n                $(data).each(function(key, value) {\n                    var user = [];\n                    user.label = value.realname;\n                    user.value = value.userid;\n                    users.push(user);\n                });\n\n                $(\"#toUsers\").autocomplete({\n                    minLength: 0,\n                    source: users,\n                    focus: function( event, ui ) {\n                        $( \"#toUsers\" ).val( ui.item.label );\n                        return false;\n                    },\n                    select: function( event, ui ) {\n                        $( \"#toUsers\" ).val( ui.item.label );\n                        $( \"#toUsersId\" ).val( ui.item.value );\n                        return false;\n                    }\n                })\n                .data( \"ui-autocomplete\" )._renderItem = function( ul, item ) {\n                    return $( \"<li>\" )\n                    .append( \"<a>\" + item.label + \"</a>\" )\n                    .appendTo( ul );\n                };\n            });\n        },\n        \n        showWriteDialog: function() {\n            $( \"#writeMail\" ).dialog({\n                height: 575,\n                width: 800,\n                modal: true,\n                show: {\n                    effect: \"fade\",\n                    duration: 500\n                },\n                hide: {\n                    effect: \"fade\",\n                    duration: 500\n                },\n                buttons: {\n                    \"Send Mail\": function() {\n                        if (mail.sendMail()) {\n                            $( this ).dialog( \"close\" );\n                            mail.showFolder();\n                        }\n                    },\n                    Cancel: function() {\n                        $( this ).dialog( \"close\" );\n                    }\n                }\n            });\n\n            $(\"textarea#mailBody\").tinymce({\n                browser_spellcheck: true,\n                forced_root_block: false,\n                resize: false,\n                menubar: \"edit format view insert tools\",\n                toolbar: \"undo redo | styleselect | bold italic underline | alignleft aligncenter alignright | bullist numlist | link | forecolor\",\n                plugins: [\n                          \"autolink link lists hr anchor pagebreak\",\n                          \"searchreplace wordcount code insertdatetime\",\n                          \"template paste textcolor\"\n                          ]\n            });\n        },\n\n        sendMail: function() {\n            var mailPiece = {};\n\n            mailPiece.to = $(\"#toUsersId\").val();\n            mailPiece.subject = $(\"#mailSubject\").val();\n            mailPiece.body = $(\"#mailBody\").val();\n\n            if (mailPiece.to !== \"\" && mailPiece.subject !== \"\" && mailPiece.body !== \"\") {\n                mailPiece = JSON.stringify(mailPiece);\n\n                $.post(\"api/i/mail/send\", {mail: mailPiece},\n                        function(data) {\n                    data = JSON.parse(data);\n                    alert(data.data);\n                });\n\n                return true;\n            }\n            else {\n                alert(\"Error: You need a subject, body, and recipient.\");\n                return false;\n            }\n        },\n        \n        deleteMail: function() {\n            var selected = this.getSelectedMailIds();\n\n            if (selected.length === 1 && confirm(\"Delete Selected Mail?\")) {\n                var permenant = false;\n                \n                if ($(\"#folder\").val() == \"trash\") {\n                    permenant = true;\n                }\n                \n                $.post(\"api/i/mail/delete\", {\"mid\": selected[0], \"permenant\": permenant},\n                    function(data) {\n                        data = JSON.parse(data);\n                        mail.showFolder();\n                        alert(data.data);\n                });\n            }\n        },\n\n        getSelectedMailIds: function() {\n            var selectedMail = [];\n\n            $(\"#mailList :checked\").each(function() {\n                selectedMail.push($(this).val());\n            });\n\n            return selectedMail;\n        }\n};","/* global $, alert */\n\n\"use strict\"; // jshint ignore:line\n\nvar permissions = {\n    // All permissions to reference for iteration\n    allPermissions: {\n      'createlog': false,\n      'editlog': false,\n      'viewlog': false,\n\n      'addcat': false,\n      'editcat': false,\n      'deletecat': false,\n\n      'adduser': false,\n      'edituser': false,\n      'deleteuser': false,\n\n      'addgroup': false,\n      'editgroup': false,\n      'deletegroup': false,\n\n      'viewcheesto': false,\n      'updatecheesto': false,\n\n      'admin': false,\n    },\n\n    currentPermissions: {\n    },\n\n    getList: function() {\n        $.get('api/i/rights/getlist', {}, null, 'json')\n          .done(function(json) {\n            // Build select dropdown of current user groups\n            var select = $('<select/>').attr('id', 'groupList');\n            select.append('<option value=\"0\">Select:</option>');\n\n            for (var key in json.data) {\n                if (!json.data.hasOwnProperty(key))\n                    continue;\n\n                var group = json.data[key];\n                select.append('<option value=\"' + group.id + '\">' + group.role + '</option>');\n            }\n\n            $('#groups').empty();\n            $('#groups').append(select);\n          });\n    },\n\n    getPermissions: function(gid) {\n        var group = typeof gid !== 'undefined' ? gid : $(\"#groupList\")[0].value;\n\n        $.get('api/i/rights/getgroup', {groupid: group}, null, 'json')\n            .done(function(json) {\n                permissions.showPermissions(json.data);\n            });\n    },\n\n    showPermissions: function(json) {\n        this.currentPermissions = json;\n\n        this.drawGrid(json);\n\n        $(\"#permissionsBlock\").css( \"display\", \"block\" );\n\n        return true;\n    },\n\n    savePermissions: function() {\n        // Copy allPermissions\n        var newPermissions = this.getGrid();\n        var group = $(\"#groupList\").val();\n\n        if (group !== 0) {\n\t\t\tvar newPermissionsJson = JSON.stringify(newPermissions);\n\n\t\t\t$.post('api/i/rights/save', { rights: newPermissionsJson, groupid: group }, null, 'json')\n\t\t\t\t.done(function( json ) {\n\t\t\t\t\talert(json.data);\n\t\t\t\t\t$(\"#permissionsForm\")[0].reset();\n\t\t\t\t\t$(\"#permissionsBlock\").css( \"display\", \"none\" );\n\t\t\t\t\t$(\"#groupList\").val( 0 );\n\t\t\t\t});\n        }\n    },\n\n    checkGrid: function(permission) {\n\t\tvar newGrid = this.allPermissions;\n\t\tvar theID = \"#\"+permission;\n\t\tvar changed;\n\n\t\tif (permission == 'admin') {\n\t\t\tif ($(theID).is( \":checked\" )) {\n\t\t\t\t// An admin user has full permissions, basically a select all\n\t\t\t\tfor (var key in newGrid) {\n\t\t\t\t\tif (newGrid.hasOwnProperty(key)) {\n\t\t\t\t\t\tnewGrid[key] = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis.drawGrid(newGrid);\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// Revert to original permissions grid\n\t\t\t\tchanged = this.currentPermissions;\n\t\t\t\tchanged[permission] = false;\n\t\t\t\tthis.drawGrid(changed);\n\t\t\t}\n\t\t}\n\n\t\telse if (permission == 'createlog' || permission == 'editlog') {\n\t\t\t// Creating and editing a log inherently means the user can view logs\n\t\t\tif ($(theID).is( \":checked\" )) {\n\t\t\t\tchanged = this.getGrid();\n\t\t\t\tchanged.viewlog = true;\n\t\t\t\tchanged[permission] = true;\n\t\t\t\tthis.drawGrid(changed);\n\t\t\t}\n\t\t}\n\n\t\telse if (permission == 'updatecheesto') {\n\t\t\tif ($(theID).is( \":checked\" )) {\n\t\t\t\tchanged = this.getGrid();\n\t\t\t\tchanged.viewcheesto = true;\n\t\t\t\tchanged[permission] = true;\n\t\t\t\tthis.drawGrid(changed);\n\t\t\t}\n\t\t}\n    },\n\n    goBack: function() {\n\t\tthis.drawGrid(this.currentPermissions);\n    },\n\n    createNew: function() {\n        $( \"#add-form\" ).dialog({\n          height: 225,\n          width: 350,\n          modal: true,\n          buttons: {\n            \"Create Group\": function() {\n                permissions.sendNew();\n                $( this ).dialog( \"close\" );\n            },\n            Cancel: function() {\n              $( this ).dialog( \"close\" );\n            }\n          }\n        });\n    },\n\n    sendNew: function() {\n        $.post('api/i/rights/create',\n\t\t\t{ name: $(\"#name\").val(), rights: JSON.stringify(permissions.allPermissions) }, null, 'json')\n          .done(function(response) {\n              $( \"#dialog\" ).html( response.data );\n              $( \"#dialog\" ).dialog({\n                  modal: true,\n                  width: 400,\n                  show: {\n                    effect: \"fade\",\n                    duration: 500\n                  },\n                  hide: {\n                    effect: \"fade\",\n                    duration: 500\n                  },\n                  buttons: {\n                    Ok: function() {\n                      $( this ).dialog( \"close\" );\n                    }\n                  }\n                });\n\n                $(\"#permissionsForm\")[0].reset();\n                $(\"#permissionsBlock\").css( \"display\", \"none\" );\n                permissions.getList();\n          });\n    },\n\n    deleteGroup: function() {\n        var delGroup = $(\"#groupList option:selected\").text();\n\n        $( \"#dialog\" ).html( \"<p>Do you really want to delete the group '\"+delGroup+\"'?</p>\" );\n        $( \"#dialog\" ).dialog({\n          resizable: false,\n          modal: true,\n          buttons: {\n            \"Delete Group\": function() {\n                $( this ).dialog( \"close\" );\n\n                var group = $(\"#groupList\").val();\n\n                $.post('api/i/rights/delete', { groupid: group }, null, 'json')\n                  .done(function( json ) {\n\n                      $( \"#dialog\" ).html( \"<p>\"+json.data+\"</p>\" );\n                      $( \"#dialog\" ).dialog({\n                          modal: true,\n                          width: 400,\n                          show: {\n                            effect: \"fade\",\n                            duration: 500\n                          },\n                          hide: {\n                            effect: \"fade\",\n                            duration: 500\n                          },\n                          buttons: {\n                            Ok: function() {\n                              $( this ).dialog( \"close\" );\n                            }\n                          }\n                        });\n\n\t\t\t\t\t\t$(\"#permissionsForm\")[0].reset();\n\t\t\t\t\t\t$(\"#permissionsBlock\").css( \"display\", \"none\" );\n                        permissions.getList();\n                  });\n            },\n            Cancel: function() {\n              $( this ).dialog( \"close\" );\n            }\n          }\n        });\n    },\n\n    drawGrid: function(object) {\n\t\tfor (var key in object) {\n           if (object.hasOwnProperty(key)) {\n              var getID = \"#\"+key;\n\n              $(getID).prop( \"checked\", object[key] );\n           }\n        }\n\n        return true;\n    },\n\n    getGrid: function() {\n\t\tvar theGrid = JSON.parse(JSON.stringify(this.allPermissions));\n\n\t\tfor (var key in theGrid) {\n\t\t\tif (theGrid.hasOwnProperty(key)) {\n\t\t\t\tvar getID = \"#\"+key;\n\n\t\t\t\ttheGrid[key] = $(getID).prop( \"checked\" );\n\t\t\t}\n\t\t}\n\n\t\treturn theGrid;\n    },\n\n    // Checks if enter key was pressed, if so submit the form\n    check: function(e) {\n        if (e.keyCode == 13) {\n            $( \"#add-form\" ).dialog( \"close\" );\n            this.sendNew();\n            e.preventDefault();\n        }\n    },\n};\n","/* global $, clearTimeout, setTimeout, window */\n/* jshint multistr: true */\n\n\"use strict\"; // jshint ignore:line\nvar newStatus = 1;\n\nvar presence =\n{\n    timeoutId: 0,\n    version: 0,\n    firstgen: true,\n\n    checkstat: function (ver) {\n        $.getJSON(\"api/i/cheesto/readall\",\n            function (data) {\n                presence.generateView(ver, data);\n                clearTimeout(presence.timeoutId);\n                delete presence.timeoutId;\n\n                presence.version = ver;\n                presence.timeoutId = setTimeout(function () {\n                    presence.checkstat(ver);\n                }, 30000);\n            });\n    },\n\n    generateView: function (ver, dataObj) {\n        dataObj = dataObj.data;\n\n        if (!this.firstgen) {\n            this.updateTableOnly(ver, dataObj);\n            return;\n        }\n\n        var appendable = $('<div/>').attr('id', 'pt');\n\n        // Generate select box of status options\n        appendable.append(presence.makeStatusSelect(ver, dataObj));\n\n        var userStatusesDiv = $('<div/>').attr('id', 'userStatuses');\n        var tableView;\n        // Generate status table depending on view version\n        if (ver === 0) {\n            tableView = this.makeTableMini(dataObj);\n        }\n        else if (ver === 1) {\n            tableView = this.makeTableFull(dataObj);\n        }\n        userStatusesDiv.append(tableView);\n        appendable.append(userStatusesDiv);\n\n        $('#mainPresence').html(appendable);\n    },\n\n    updateTableOnly: function (ver, dataObj) {\n        var tableView;\n        // Generate status table depending on view version\n        if (ver === 0) {\n            tableView = this.makeTableMini(dataObj);\n        }\n        else if (ver === 1) {\n            tableView = this.makeTableFull(dataObj);\n        }\n        $('#userStatuses').html(tableView);\n    },\n\n    /**\n     * @param {{statusOptions:string}} dataObj\n     */\n    makeStatusSelect: function (ver, dataObj) {\n        var statusSelectDiv = $('<div/>').attr('id', 'statusSelect');\n        var statusSelect = $('<select/>').attr('id', 'cstatus');\n        statusSelect.change(function () {\n            presence.setStatus(ver);\n        });\n        statusSelect.append('<option value=\"-1\">Set Status:</option>');\n\n        for (var key2 in dataObj.statusOptions) {\n            var html = '<option>' + dataObj.statusOptions[key2] + '</option>';\n            statusSelect.append(html);\n        }\n\n        statusSelectDiv.append(statusSelect);\n        this.firstgen = false;\n        return statusSelectDiv;\n    },\n\n    /**\n     * @param {{statusInfo:object}} dataObj\n     */\n    makeTableMini: function (dataObj) {\n        // Mini view on main page\n        var table = $('<table/>');\n        var tableHead = '<thead><tr>\\\n            <td width=\"50%\">Name</td>\\\n            <td width=\"50%\">Status</td>\\\n            </tr></thead>';\n\n        table.append(tableHead);\n\n        for (var key in dataObj) {\n            if (!dataObj.hasOwnProperty(key))\n                continue;\n\n            if (key !== \"statusOptions\") {\n                var user = dataObj[key];\n                var classm = '';\n\n                if (user.message !== '') {\n                    classm = ' class=\"message\"';\n                }\n\n                var html = '<tr>\\\n                    <td class=\"textLeft\"><span title=\"' + user.message + '\"' + classm + '>' + user.realname + '</span></td>\\\n                    <td><span title=\"' + dataObj.statusOptions[user.status] + '&#013;Return: ' + user.returntime + '\" class=\"' + user.statusInfo.color + '\">' + user.statusInfo.symbol + '</td>\\\n                    </tr>';\n\n                table.append(html);\n            }\n        }\n\n        var popOutButton = '<tr><td colspan=\"3\" width=\"100%\" class=\"cen\">\\\n            <form><input type=\"button\" onClick=\"presence.popOut();\" class=\"linklike\" value=\"Popout &#264;eesto\"></form>\\\n            </td></tr>';\n        table.append(popOutButton);\n\n        return table;\n    },\n\n    /**\n     * @param {{realname:string}} dataObj\n     */\n    makeTableFull: function (dataObj) {\n        // Windowed view\n        var table = $('<table/>');\n        var tableHead = '<thead><tr><td>Name</td>\\\n            <td>Message</td>\\\n            <td colspan=\"2\">Status</td>\\\n            <td>Last Changed</td>\\\n            </tr></thead><tbody>';\n        table.append(tableHead);\n\n        for (var key in dataObj) { // jshint ignore:line\n            if (!dataObj.hasOwnProperty(key))\n                continue;\n\n            if (key !== \"statusOptions\") {\n                var user = dataObj[key];\n\n                var html = '<tr>\\\n                    <td>' + user.realname + '</td>\\\n                    <td>' + user.message + '</td>\\\n                    <td class=\"statusi\"><span class=\"' + user.statusInfo.color + '\">' + user.statusInfo.symbol + '</span></td>';\n\n                if (user.status == 0) { // jshint ignore:line\n                    html += '<td>' + dataObj.statusOptions[user.status] + '</td>';\n                } else {\n                    html += '<td>' + dataObj.statusOptions[user.status] + '<br>Return: ' + user.returntime + '</td>';\n                }\n\n                html += '<td>' + user.dmodified + '</td></tr>';\n\n                table.append(html);\n            }\n        }\n\n        return table;\n    },\n\n    setStatus: function (ver) {\n        newStatus = $(\"select#cstatus\").prop(\"selectedIndex\") - 1;\n        $(\"select#cstatus\").prop(\"selectedIndex\", 0);\n        var rtime;\n\n        if (newStatus > 0) {\n            // Status requires a return time and optional status\n            rtime = \"\"; // jshint ignore:line\n            window.open(\"getdate\", \"getdate\", \"location=no,menubar=no,scrollbars=no,status=no,height=550,width=350\");\n        }\n        else if (newStatus === 0) {\n            // Status is Available\n            rtime = \"00:00:00\"; // jshint ignore:line\n            presence.sendNewStatus(0, rtime, ver, \"\");\n        }\n    },\n\n    popOut: function () {\n        window.open(\"presenceWindow\", \"presencewin\", \"location=no,menubar=no,scrollbars=no,status=no,height=500,width=950\");\n    },\n\n    sendNewStatus: function (stat, rt, ver, message) {\n        $.post(\"api/i/cheesto/update\", {status: stat, returntime: rt, message: message},\n            function () {\n                presence.checkstat(ver);\n            });\n    },\n\n    showHideP: function () {\n        if ($(\"#showHide\").html() == \"[ - ]\") {\n            $(\"#presence\").css(\"minWidth\", $(\"#mainPresence\").prop(\"offsetWidth\") + \"px\");\n            $(\"#mainPresence\").css(\"display\", \"none\");\n            $(\"#showHide\").html(\"[ + ]\");\n        }\n        else {\n            $(\"#presence\").css(\"minWidth\", \"0px\");\n            $(\"#mainPresence\").css(\"display\", \"\");\n            $(\"#showHide\").html(\"[ - ]\");\n        }\n    }\n};\n","/* global $, location, alert*/\n\n\"use strict\"; // jshint ignore:line\n\nvar api = {\n    resetPassword: function() {\n        var pw1 = $(\"#pass1\").val();\n        var pw2 = $(\"#pass2\").val();\n        $(\"#pass1\").val('');\n        $(\"#pass2\").val('');\n\n        if (pw1 === pw2 && pw1 !== \"\") {\n            $.post('api/i/users/resetPassword', {'pw': pw1}, null, \"json\")\n                .done(function(msg) {\n                    alert(msg.data);\n                    location.assign('/logout');\n                });\n        } else {\n            alert('Passwords do not match or are empty');\n        }\n    }\n};\n","/* global $, document, alert*/\n\n\"use strict\"; // jshint ignore:line\n\n$(function(){\n    api.getApiKey();\n});\n\nvar api = {\n    getApiKey: function() {\n        $.getJSON(\"api/i/keyManager/getKey\",\n            function(data) {\n                $(\"#apiKey\").html('API Key: '+data.data.key);\n        });\n    },\n\n    generateKey: function() {\n        $.getJSON(\"api/i/keyManager/newKey\",\n            function(data) {\n                $(\"#apiKey\").html('API Key: '+data.data.key);\n        });\n    },\n\n    showResetPasswordForm: function() {\n        $(\"#passwordResetDialog\").dialog({\n            height: 300,\n            width: 450,\n            modal: true,\n            show: {\n                effect: \"fade\",\n                duration: 500\n            },\n            hide: {\n                effect: \"fade\",\n                duration: 500\n            },\n            buttons: {\n                \"Reset\": function() {\n                    api.resetPassword();\n                },\n                Cancel: function() {\n                    $( this ).dialog(\"close\");\n                }\n            }\n        });\n    },\n\n    resetPassword: function() {\n        var pw1 = $(\"#pass1\").val();\n        var pw2 = $(\"#pass2\").val();\n        $(\"#pass1\").val('');\n        $(\"#pass2\").val('');\n\n        if (pw1 === pw2 && pw1 !== \"\") {\n            $.post('api/i/users/resetPassword', {'pw': pw1}, null, \"json\")\n                .done(function(msg) {\n                    $(\"#passwordResetDialog\").dialog(\"close\");\n                    alert(msg.data);\n                });\n        } else {\n            alert('Passwords do not match or are empty');\n        }\n    },\n\n    saveLogLimit: function() {\n        var limit = $('#show_limit').val();\n        $.post('api/i/usersettings/saveLogLimit', {'limit': limit}, null, \"json\")\n            .done(function(msg) {\n                alert(msg.data);\n            });\n    },\n\n    saveTheme: function() {\n        var theme = $('#userTheme').val();\n        $.post('api/i/usersettings/saveTheme', {'theme': theme}, null, \"json\")\n            .done(function(msg) {\n                alert(msg.data);\n                document.location.reload(true);\n            });\n    }\n};\n","/* global $, alert, console */\n\n\"use strict\"; // jshint ignore:line\n\nvar userManager = {\n\trights: {},\n    currentuid: null,\n\n\tinit: function() {\n\t\tthis.getUsersRights();\n\t\tthis.loadCommandList();\n\t\tthis.loadUserList();\n\t},\n\n\tgetUsersRights: function() {\n        $.ajax('api/i/rights/getUsersRights', {\n        \tasync: false, // To ensure permissions are loaded before command list is generated\n        \tdataType: 'json'\n        })\n            .done(function(json) {\n            \tif (json.errorcode === 0) {\n\t\t\t\t\tuserManager.rights = json.data;\n            \t} else {\n            \t\talert(json.status);\n            \t}\n            \treturn;\n            });\n        return;\n\t},\n\n\tloadCommandList: function() {\n\t\tvar commands = $('<select/>').attr('id', 'commands');\n\n\t\tcommands.append('<option value=\"\">Select Command:</option>');\n\n\t    if (this.rights.adduser) {\n            commands.append('<option value=\"add\">Add User</option>');\n        }\n\n        if (this.rights.deleteuser) {\n            commands.append('<option value=\"delete\">Delete</option>');\n        }\n\n        if (this.rights.edituser) {\n            commands.append('<option value=\"edit\">Edit</option>');\n            commands.append('<option value=\"reset\">Reset Password</option>');\n            commands.append('<option value=\"cxeesto\">Change &#264;eesto</option>');\n            commands.append('<option value=\"revokeKey\">Revoke API Key</option>');\n        }\n\n        $('#userManageForm').prepend(commands);\n        return;\n\t},\n\n\tloadUserList: function() {\n\t\t$.getJSON(\"api/i/users/getUsersList\",\n                    function(data){\n                    \tif (data.errorcode === 0) {\n                    \t\tuserManager.displayUserList(data.data);\n                    \t} else {\n                    \t\t$('#userlist').html(data.status);\n                    \t}\n                    \treturn;\n                \t});\n\t\treturn;\n\t},\n\n\tdisplayUserList: function(userdata) {\n\t\tvar userTable = $('<table/>');\n        // jshint multistr:true\n\t\tvar header = '<tr>\\\n\t\t                <th>&nbsp;</th>\\\n\t\t                <th>Real Name</th>\\\n\t\t                <th>Username</th>\\\n\t\t                <th>Role</th>\\\n\t\t                <th>Date Created</th>\\\n\t\t                <th>Theme</th>\\\n\t\t                <th>First Login</th>\\\n\t\t            </tr>';\n        userTable.append(header);\n\n        for (var key in userdata) {\n            if (!userdata.hasOwnProperty(key))\n                continue;\n\n\t\t\tvar user = userdata[key];\n            var html = '<tr>\\\n\t                    \t<td><input type=\"radio\" name=\"uid\" value=\"' + user.userid + '\"></td>\\\n\t                    \t<td style=\"text-align: left;\">' + user.realname + '</td>\\\n\t                    \t<td>' + user.username + '</td>\\\n\t                    \t<td>' + user.role + '</td>\\\n\t                    \t<td>' + user.datecreated + '</td>\\\n\t                    \t<td>' + user.theme + '</td>\\\n\t                    \t<td>' + user.firsttime + '</td>\\\n                    \t</tr>';\n        \tuserTable.append(html);\n        }\n\n\t\t$('#userlist').empty();\n        $('#userlist').append(userTable);\n        return;\n\t},\n\n\tperformAction: function() {\n        // Get the action to perform\n\t\tvar action = $('#commands').val();\n\t\t$('#commands').prop(\"selectedIndex\", 0);\n\t\tif (action === '') {\n\t\t\treturn false;\n\t\t}\n\n        // Make sure a user is selected\n        var uid = $('input[name=uid]:checked').val();\n        if (typeof uid == 'undefined' && action != 'add') {\n            return false;\n        }\n        this.currentuid = uid;\n\n        // Show dialog for action\n        $('#dialog').empty();\n\t\tuserManager.uiforms[action]();\n\t\treturn;\n\t},\n\n\tadd: function() { // Create user\n\t\tvar username = $('#add_user').val();\n        var password = $('#add_pass').val();\n        var fullname = $('#add_fullname').val();\n        var group = $('#add_group').val();\n\n        $.post('api/i/users/create', {username: username, password: password, fullname: fullname, role: group}, null, 'json')\n            .done(function(data) {\n                console.log(data);\n                userManager.loadUserList();\n            });\n        return;\n\t},\n\n\tedit: function() { // Edit user\n        var uid = $('#edit_uid').val();\n        var theme = $('#edit_theme').val();\n        var fullname = $('#edit_fullname').val();\n        var group = $('#edit_group').val();\n        var prompt = $('#edit_prompt').val();\n\n        $.post('api/i/users/save', {uid: uid, fullname: fullname, role: group, prompt: prompt, theme: theme}, null, 'json')\n            .done(function(data) {\n                console.log(data);\n                userManager.loadUserList();\n            });\n        return;\n\t},\n\n\tdelete: function() { // Delete user\n        $.post('api/i/users/delete', {uid: userManager.currentuid}, null, 'json')\n            .done(function(data) {\n                if (data.errorcode === 0 && data.data === true) {\n                    console.log('Success');\n                    userManager.loadUserList();\n                }\n            });\n        return;\n\t},\n\n\treset: function() { // Reset user password\n        var pass1 = $('#pass1').val();\n        var pass2 = $('#pass2').val();\n        $(\"#pass1\").val('');\n        $(\"#pass2\").val('');\n\n        if (pass1 === pass2 && pass1 !== \"\") {\n            $.post('api/i/users/resetPassword', {pw: pass1, uid: userManager.currentuid}, null, \"json\")\n                .done(function(data) {\n                    if (data.errorcode === 0 && data.data === true) {\n                        console.log('Success');\n                    }\n                });\n        } else {\n            alert('Passwords do not match or are empty');\n        }\n        return;\n\t},\n\n\tcxeesto: function() { // Change user status\n        var uid = $('#status_uid').val();\n        var status = $(\"select#status_text\").prop(\"selectedIndex\") - 1;\n        var message = $('#status_message').val();\n        var returntime = $('#status_return').val();\n\n        $.post('api/i/cheesto/update', {uid: uid, status: status, returntime: returntime, message: message}, null, 'json')\n            .done(function(data) {\n                console.log(data);\n                userManager.loadUserList();\n            });\n        return;\n\t},\n\n\trevokeKey: function() { // Revoke user's api key\n\t\t$.post('api/i/keymanager/revokekey', {uid: userManager.currentuid}, null, 'json')\n            .done(function(data) {\n                if (data.errorcode === 0 && data.data.key === true) {\n                    console.log('Success');\n                }\n            });\n        return;\n\t},\n};\n","/* global $, alert, userManager */\n\n\"use strict\"; // jshint ignore:line\n\nuserManager.uiforms = {\n    add: function() { // Create user form\n        var rightsList = null;\n\n        $.ajax('api/i/rights/getlist', {\n            async: false,\n            dataType: 'json'\n        })\n            .done(function(json) {\n                if (json.errorcode === 0) {\n                    rightsList = json.data;\n                } else {\n                    alert(json.status);\n                }\n                return;\n            });\n\n        var table = $('<table/>');\n        table.append('<tr><td>Username:</td><td><input type=\"text\" id=\"add_user\" autocomplete=\"off\"></td></tr>');\n        table.append('<tr><td>Password:</td><td><input type=\"password\" id=\"add_pass\"></td></tr>');\n        table.append('<tr><td>Real Name:</td><td><input type=\"text\" id=\"add_fullname\" autocomplete=\"off\"></td></tr>');\n\n        var roleRow = $('<tr/>');\n        roleRow.append('<td>Role:</td>');\n\n        var roleCell = $('<td/>');\n        var select = $('<select/>').attr('id', 'add_group');\n        select.append('<option value=\"0\">Select:</option>');\n        for (var key in rightsList) {\n            if (!rightsList.hasOwnProperty(key))\n                continue;\n\n            var group = rightsList[key];\n            select.append('<option value=\"' + group.role + '\">' + group.role + '</option>');\n        }\n        roleCell.append(select);\n        roleRow.append(roleCell);\n        table.append(roleRow);\n\n        $('#dialog').append(table);\n        this.showDialogBox('add', {title: 'Add new user', buttonText1: 'Add'});\n        return;\n    },\n\n    edit: function() { // Edit user form\n        var userinfo = null;\n        var rightsList = null;\n        var themeList = null;\n\n        // Load user\n        $.ajax('api/i/users/getuserinfo', {\n            async: false,\n            dataType: 'json',\n            data: {uid: userManager.currentuid}\n        })\n            .done(function(json) {\n                if (json.errorcode === 0) {\n                    userinfo = json.data;\n                } else {\n                    alert(json.status);\n                }\n                return;\n            });\n\n        // Load rights groups\n        $.ajax('api/i/rights/getlist', {\n            async: false,\n            dataType: 'json'\n        })\n            .done(function(json) {\n                if (json.errorcode === 0) {\n                    rightsList = json.data;\n                } else {\n                    alert(json.status);\n                }\n                return;\n            });\n\n        // Load theme list\n        $.ajax('api/i/usersettings/getthemelist', {\n            async: false,\n            dataType: 'json'\n        })\n            .done(function(json) {\n                if (json.errorcode === 0) {\n                    themeList = json.data;\n                } else {\n                    alert(json.status);\n                }\n                return;\n            });\n\n        var table = $('<table/>');\n        table.append('<tr><td>User ID:</td><td><input type=\"text\" id=\"edit_uid\" value=\"'+userinfo.userid+'\" readonly></td></tr>');\n        table.append('<tr><td>Real Name:</td><td><input type=\"text\" id=\"edit_fullname\" value=\"'+userinfo.realname+'\" autocomplete=\"off\"></td></tr>');\n\n        // Build and append row for rights groups select box\n        var roleRow = $('<tr/>');\n        roleRow.append('<td>Role:</td>');\n        var roleCell = $('<td/>');\n        var select = $('<select/>').attr('id', 'edit_group');\n        for (var key in rightsList) {\n            if (!rightsList.hasOwnProperty(key))\n                continue;\n\n            var group = rightsList[key];\n            var selected = '';\n            if (group.role == userinfo.role) { selected = 'selected'; }\n            select.append('<option value=\"' + group.role + '\" '+selected+'>' + group.role + '</option>');\n        }\n        roleCell.append(select);\n        roleRow.append(roleCell);\n        table.append(roleRow);\n\n        // Build and append row for theme select box\n        var themeRow = $('<tr/>');\n        themeRow.append('<td>Theme:</td>');\n        var themeCell = $('<td/>');\n        var select1 = $('<select/>').attr('id', 'edit_theme');\n        if (userinfo.theme === '') { select1.append('<option value=\"\" selected>Default</option>'); }\n        else { select1.append('<option value=\"\">Default</option>'); }\n\n        for (var key1 in themeList) {\n            if (!themeList.hasOwnProperty(key1))\n                continue;\n\n            var theme = themeList[key1];\n            var selected1 = '';\n            if (theme == userinfo.theme) { selected1 = 'selected'; }\n            select1.append('<option value=\"' + theme + '\" '+selected1+'>' + theme + '</option>');\n        }\n        themeCell.append(select1);\n        themeRow.append(themeCell);\n        table.append(themeRow);\n\n        table.append('<tr><td>Date Created:</td><td><input type=\"text\" value=\"'+userinfo.datecreated+'\" readonly></td></tr>');\n        table.append('<tr><td>Prompt:</td><td><input type=\"text\" id=\"edit_prompt\" value=\"'+userinfo.firsttime+'\"></td></tr>');\n\n        $('#dialog').append(table);\n        this.showDialogBox('edit', {title: 'Edit user', buttonText1: 'Save', height: 330});\n        return;\n    },\n\n    delete: function() { // Delete user form\n        $('#dialog').append('Are you sure you want to delete user X?');\n        this.showDialogBox('delete', {buttonText1: 'Yes', buttonText2: 'No'});\n        return;\n    },\n\n    reset: function() { // Reset user password form\n        // jshint multistr:true\n        $('#dialog').append('<table>\\\n                                <tr><td>New Password:</td><td><input type=\"password\" id=\"pass1\"></td></tr>\\\n                                <tr><td>Repeat Password:</td><td><input type=\"password\" id=\"pass2\"></td></tr>\\\n                            </table>');\n        this.showDialogBox('reset', {buttonText1: 'Reset'});\n        return;\n    },\n\n    cxeesto: function() { // Change user status form\n        var status = null;\n\n        // Load user\n        $.ajax('api/i/cheesto/read', {\n            async: false,\n            dataType: 'json',\n            data: {uid: userManager.currentuid}\n        })\n            .done(function(json) {\n                if (json.errorcode === 0) {\n                    status = json;\n                } else {\n                    alert(json.status);\n                }\n                return;\n            });\n\n        var table = $('<table/>');\n        table.append('<tr><td>User ID:</td><td><input type=\"text\" id=\"status_uid\" value=\"'+status.data.uid+'\" readonly></td></tr>');\n        table.append('<tr><td>Name:</td><td><input type=\"text\" id=\"status_name\" value=\"'+status.data.realname+'\" readonly></td></tr>');\n\n        var statusRow = $('<tr/>');\n        statusRow.append('<td>Status:</td>');\n        var statusCell = $('<td/>');\n        var statusSelect = $('<select/>').attr('id', 'status_text');\n        statusSelect.append('<option value=\"-1\">Set Status:</option>');\n        for (var key in status.data.statusOptions) {\n            statusSelect.append('<option>'+status.data.statusOptions[key]+'</option>');\n        }\n        statusCell.append(statusSelect);\n        statusRow.append(statusCell);\n        table.append(statusRow);\n\n        table.append('<tr><td>Message:</td><td><textarea cols=\"30\" rows=\"5\" id=\"status_message\">'+status.data.message+'</textarea></td></tr>');\n        table.append('<tr><td>Return:</td><td><input type=\"text\" id=\"status_return\" value=\"'+status.data.returntime+'\"></td></tr>');\n\n        $('#dialog').append(table);\n\n        $('#status_return').datetimepicker({\n                        timeFormat: \"HH:mm\",\n                        controlType: 'select',\n                        stepMinute: 10\n                    });\n\n        this.showDialogBox('cxeesto', {title: 'Set User Status', height: 380, width: 515, buttonText1: 'Save'});\n        return;\n    },\n\n    revokeKey: function() { // Confirm key revoke form\n        $('#dialog').append('Are you sure you want to revoke the API key for user X?');\n        this.showDialogBox('revokeKey', {buttonText1: 'Yes', buttonText2: 'No'});\n        return;\n    },\n\n    showDialogBox: function(func, customize) {\n        // Check customization settings\n        if (typeof customize == 'undefined') {\n            customize = {};\n        }\n        if (typeof customize.height == 'undefined') {\n            customize.height = 300;\n        }\n        if (typeof customize.width == 'undefined') {\n            customize.width = 450;\n        }\n        if (typeof customize.title == 'undefined') {\n            customize.title = '';\n        }\n        if (typeof customize.buttonText1 == 'undefined') {\n            customize.buttonText1 = 'Okay';\n        }\n        if (typeof customize.buttonText2 == 'undefined') {\n            customize.buttonText2 = 'Cancel';\n        }\n\n        // Build dialog buttons\n        var dialog_buttons = {};\n\n        dialog_buttons[customize.buttonText1] = function() {\n            $(this).dialog(\"close\");\n            userManager[func]();\n            return;\n        };\n        dialog_buttons[customize.buttonText2] = function() {\n            $(this).dialog(\"close\");\n            return;\n        };\n\n        // Build and show dialog\n        $(\"#dialog\").attr('title', customize.title);\n        $(\"#dialog\").dialog({\n            height: customize.height,\n            width: customize.width,\n            modal: true,\n            show: {\n                effect: \"fade\",\n                duration: 500\n            },\n            hide: {\n                effect: \"fade\",\n                duration: 250\n            },\n            buttons: dialog_buttons\n        });\n\n        return;\n    },\n};\n"],"sourceRoot":"/source/"}