"use strict";var CategoryManage={currentID:-1,currentSelection:[0],addEditLog:!1,grabNextLevel:function(e,t){t=this.addEditLog?"#catSpace":"#categorySelects";var n=e.split(":"),r=+n[0]+1,a=+n[1];this.currentSelection[r]&&this.currentSelection.splice(r),this.currentSelection[r]=a,$.get("render/categoriesJson",{pastSelection:JSON.stringify(this.currentSelection)},null,"json").done(function(n){"undefined"!=typeof $(t)[0]&&($(t).empty(),$(t).html(CategoryManage.renderSelectsFromJson(n)),CategoryManage.currentID=e)})},grabFirstLevel:function(){this.grabNextLevel("-1:0")},renderSelectsFromJson:function(e){CategoryManage.currentSelection=e.currentList;var t=$("<span/>"),n=function(){CategoryManage.grabNextLevel(this.value)};for(var r in e.levels)if(e.levels.hasOwnProperty(r)){var a=$("<select/>").attr("id","level"+r);a.change(n),a.append('<option value="">Select:</option>');for(var o in e.levels[r])if(e.levels[r].hasOwnProperty(o)){var i=e.levels[r][o],l=$('<option value="'+r+":"+i.id+'">'+i.desc+"</option>");l.attr("selected",i.selected),a.append(l)}t.append(a)}return t},renderCategoriesFromString:function(e,t){$.get("render/editcat",{catstring:e},null,"json").done(function(e){var n=CategoryManage.renderSelectsFromJson(e);t(n)})},createNew:function(){var e=this.getCatString(),t="Add new category\n\n";for(1==this.currentSelection.length&&(t="Create new root category:",e="");;){var n=window.prompt(t+e);if(""!==n){if(null===n)return!1;this.addNew(encodeURIComponent(n));break}alert("Please enter a category description")}},addNew:function(e){var t=e,n=this.currentSelection[this.currentSelection.length-1];$.post("api/i/categories/add",{parentID:n,catDesc:t},null,"json").done(function(e){alert(e.data),CategoryManage.grabNextLevel(CategoryManage.currentSelection[CategoryManage.currentSelection.length-2])})},editCat:function(){var e=this.currentSelection[this.currentSelection.length-1],t=this.currentSelection.length-2,n=$("#level"+t+" option:selected");if("undefined"!=typeof n.val()){var r=n.text(),a=window.prompt("Edit Category Description:",r);null!==a&&""!==a&&$.post("api/i/categories/edit",{cid:e,catDesc:encodeURIComponent(a)},null,"json").done(function(e){alert(e.data),CategoryManage.grabNextLevel(CategoryManage.currentSelection[CategoryManage.currentSelection.length-2])})}},deleteCat:function(){var e=this.getCatString(),t=this.currentSelection[this.currentSelection.length-1];return window.confirm("Delete "+e+"?\n\nWarning: All child categories will be moved up one level!")?void $.post("api/i/categories/delete",{cid:t},null,"json").done(function(e){alert(e.data),CategoryManage.grabNextLevel(CategoryManage.currentSelection[CategoryManage.currentSelection.length-2])}):!1},getCatString:function(){for(var e="",t=0;t<this.currentSelection.length;t++)if($("#level"+t)){var n=$("#level"+t+" option:selected");"Select:"!=n.text()&&(e+=n.text()+":")}return e.length>0?e.substring(0,e.length-1):!1}};
//# sourceMappingURL=maps/catManage.min.js.map