"use strict";var adminAction={editSlogan:function(e){var n=window.prompt("Website Slogan",e);""!==n&&null!==n&&this.performAction("saveSlogan",n)},backupDB:function(){this.performAction("backupDB",null)},saveDefaultTheme:function(){var e=$("#userTheme").val();this.performAction("saveDefaultTheme",e)},saveCheesto:function(){var e=$("#cheesto_enabled").val();this.performAction("saveCheesto",e)},saveApiSetting:function(){var e=$("#api_enabled").val();this.performAction("savePAPI",e)},performAction:function(e,n){$.post("api/i/admin/"+e,{data:encodeURIComponent(n)},null,"json").done(function(e){alert(e.data)})}};
"use strict";var CategoryManage={currentID:-1,currentSelection:[],addLog:!1,grabNextLevel:function(e,t){var n;n=e.value?e.value:e,t=this.addLog?"#catSpace":"#categorySelects";var r=n.split(":");this.currentSelection[r[1]]&&this.currentSelection.splice(r[1]),this.currentSelection[r[1]]=n,0===this.currentSelection.length&&(this.currentSelection[0]="0:0"),$.ajax({type:"POST",url:"lib/categories",data:{action:"grabcats",pastSelections:JSON.stringify(this.currentSelection)},async:!1}).done(function(e){if("undefined"!=typeof $("#categorySelects")[0]){$("#categorySelects").html(""),$(t).html(e),CategoryManage.currentID=n;for(var r=1;r<CategoryManage.currentSelection.length;r++)$("#level"+r).val(CategoryManage.currentSelection[r])}})},createNew:function(){var e=this.getCatString(),t="Add new category\n\n";for(1==this.currentSelection.length&&(t="Create new root category:",e="");;){var n=window.prompt(t+e);if(""!==n){if(null===n)return!1;this.addNew(encodeURIComponent(n));break}alert("Please enter a category description")}},addNew:function(e){var t=e,n=this.currentSelection[this.currentSelection.length-1].split(":");n=n[0],$.post("api/i/categories/add",{parentID:n,catDesc:t},null,"json").done(function(e){alert(e.data),CategoryManage.grabNextLevel(CategoryManage.currentSelection[CategoryManage.currentSelection.length-2])})},editCat:function(){var e=this.currentSelection[this.currentSelection.length-1].split(":"),t=$("#level"+e[1]+" option:selected");if("undefined"!=typeof t.val()){var n=t.text(),r=window.prompt("Edit Category Description:",n);null!==r&&""!==r&&$.post("api/i/categories/edit",{cid:e[0],catDesc:encodeURIComponent(r)},null,"json").done(function(e){alert(e.data),CategoryManage.grabNextLevel(CategoryManage.currentSelection[CategoryManage.currentSelection.length-2])})}},deleteCat:function(){var e=this.getCatString(),t=this.currentSelection[this.currentSelection.length-1].split(":");return t=t[0],window.confirm("Delete "+e+"?\n\nWarning: All child categories will be moved up one level!")?void $.post("api/i/categories/delete",{cid:t},null,"json").done(function(e){alert(e.data),CategoryManage.grabNextLevel(CategoryManage.currentSelection[CategoryManage.currentSelection.length-2])}):!1},getCatString:function(){for(var e="",t=0;t<this.currentSelection.length;t++)if($("#level"+(t+1))){var n=$("#level"+(t+1)+" option:selected");"Select:"!=n.text()&&(e+=n.text()+":")}return e.length>0?e.substring(0,e.length-1):!1}};
"use strict";function giveTime(){var e=window.opener.newStatus,t=$("#datepick").val(),n=window.opener.presence.version,i=$("#messagetext").val();i=encodeURIComponent(i),window.opener.presence.sendNewStatus(e,t,n,i),window.close()}function setDateTime(e){var t=new Date,n=t.getMinutes()+e%60,i=t.getHours()+(e-e%60)/60;n>59&&(n-=60,i++);var o=("0"+(t.getMonth()+1)).slice(-2)+"/"+("0"+t.getDate()).slice(-2)+"/"+t.getFullYear()+" "+("0"+i).slice(-2)+":"+("0"+n).slice(-2);$("#datepick").val(o)}$(document).ready(function(){$("#datepick").datetimepicker({timeFormat:"HH:mm",controlType:"select",stepMinute:10})});
"use strict";function attemptLogin(){var e=$("#username").val(),n=$("#password").val(),o=$("#rememberMe").prop("checked");return""===e||""===n?!1:void $.post("/login",{user:e,pass:n,remember:o},null,"json").done(function(e){return"1"!=e&&"2"!=e?void alert(e):void("2"==e?location.assign("/reset"):"1"==e&&location.assign("/"))})}function check(e){13==e.keyCode&&attemptLogin()}function getCookie(e){var n=new RegExp(e+"=([^;]+)"),o=n.exec(document.cookie);return null!==o?unescape(o[1]):null}!function(){var e=getCookie("dan_username");null!==e?($("#remember").css("display","none"),$("#username").val(e),$("#password").focus()):$("#username").focus()}();
"use strict";function showDialog(e){$("#dialog").html("<p>"+e+"</p>"),$("#dialog").dialog({modal:!0,width:400,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500},buttons:{Ok:function(){$(this).dialog("close")}}})}var filt=!1,refreshc;$(document).ready(function(){$("#datesearch").datepicker(),$("#datesearch").change(function(){$("#datesearch").datepicker("option","dateFormat","yy-mm-dd")}),$("#add_edit").css("display","none")}),$(document).on("focusin",function(e){$(e.target).closest(".mce-window").length&&e.stopImmediatePropagation()}),tinymce.init({browser_spellcheck:!0});var refreshFun={runFirst:function(){refreshFun.refreshLog(),CategoryManage.grabNextLevel("0:0"),this.startrefresh()},startrefresh:function(){refreshc=setInterval(function(){refreshFun.refreshLog()},6e4)},stoprefresh:function(){clearInterval(refreshc)},refreshLog:function(e){e&&(filt=!1,$("#searchterm").val("Keyword"),$("#datesearch").val("Date"),refreshFun.startrefresh()),filt||$.ajax({type:"POST",url:"api/i/logs/read",async:!1,dataType:"json"}).done(function(e){""===e&&window.location.reload(!0),view.makeLogView(e.data)}).fail(function(e){"undefined"!=typeof e&&4===e.readyState&&404===e.status&&$("#refreshed").html("An error has occured. Please try logging out and back in.")})}},view={makeLogView:function(e){$("#refreshed").empty(),filt&&$("#refreshed").append(view.showFilterMessage()),$("#refreshed").append(view.pageControls(e.metadata)),$("#refreshed").append(view.displayLogs(e)),$("#refreshed").append(view.pageControls(e.metadata))},showFilterMessage:function(){var e=$("<form/>"),t='<h3>You are viewing filtered results                    <button type="button" onClick="refreshFun.refreshLog(true)">Clear Results</button></h3>';return e.append(t),e},pageControls:function(e){if(filt)return!1;var t=$("<div/>").attr("class","pagination"),a='<form method="post">';if(e.offset>0){var o=e.offset-e.limit;a+='<input type="button" value="Previous '+e.limit+'" onClick="view.pagentation('+o+');" class="flle">'}if(e.offset+e.limit<e.logSize){var n=e.offset+e.limit;a+='<input type="button" value="Next '+e.limit+'" onClick="view.pagentation('+n+');" class="flri">'}return a+="</form></div>",t.append(a),t},displayLogs:function(e){var t=$("<div/>").attr("id","refreshed_core");for(var a in e)if(e.hasOwnProperty(a)&&"metadata"!=a){var o=e[a],n=o.realname;""===n&&(n="Unknown User");var r='<form method="post">                        <div class="logentry">                        <h2>'+o.title+'</h2>                        <p class="entry">'+o.entry+'</p>                        <p class="entrymeta">Created by '+n+" on "+o.datec+" @ "+o.timec+" ";"1"==o.edited&&(r+="(Edited)"),r+="<br>Categorized as "+o.cat+'                     <br><a href="#" onClick="searchFun.filter(\''+o.cat+"');\">Learn more about this system...</a>",o.canEdit&&(r+='<input type="button" value="Edit" onClick="editFun.grabedit('+o.logid+');" class="flri">'),r+="</p></div></form>",t.append(r)}return t},pagentation:function(e){$.post("api/i/logs/read",{offset:e},null,"json").done(function(t){view.makeLogView(t.data),0>=e?(refreshFun.refreshLog(),refreshFun.startrefresh()):refreshFun.stoprefresh(),window.scrollTo(0,0)}).fail(function(e){"undefined"!=typeof e&&4===e.readyState&&404===e.status&&$("#refreshed").html("An error has occured. Please try logging out and back in.")})}},addFun={showaddinputs:function(){$("#add_edit_form")[0].reset(),$("textarea#logEntry").html(""),$("#add_edit").dialog({height:575,width:800,modal:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500},buttons:{"Add Log":function(){addFun.addlog()},Cancel:function(){$(this).dialog("close"),CategoryManage.addLog=!1,CategoryManage.grabNextLevel("0:0")}}}),$("textarea#logEntry").tinymce({browser_spellcheck:!0,forced_root_block:!1,resize:!1,menubar:"edit format view insert tools",toolbar:"undo redo | styleselect | bold italic underline | alignleft aligncenter alignright | bullist numlist | link | forecolor",plugins:["autolink link lists hr anchor pagebreak","searchreplace wordcount code insertdatetime","template paste textcolor"]}),CategoryManage.addLog=!0,CategoryManage.grabNextLevel("0:0")},addlog:function(){var e=$("input#logTitle").val();e=encodeURIComponent(e);var t=$("textarea#logEntry").val();t=encodeURIComponent(t);var a=CategoryManage.getCatString();""!==e&&""!==t&&""!==a?($("#add_edit").dialog("close"),$("#messages").fadeOut(),$.post("api/i/logs/create",{title:e,body:t,cat:a},null,"json").done(function(e){refreshFun.refreshLog(),CategoryManage.addLog=!1,CategoryManage.grabNextLevel("0:0"),showDialog(e.data)})):($("input#logTitle").val(decodeURIComponent(e)),$("textarea#logEntry").html(decodeURIComponent(t)),$("#messages").html('<span class="bad">Log entries must have a title, category, and entry text.</span>').fadeIn(),CategoryManage.addLog=!0,CategoryManage.grabNextLevel("0:0"),setTimeout(function(){$("#messages").fadeOut()},1e4))}},editFun={showeditinputs:function(e){var t=e.data;$("input#logTitle").val(t.title),$("textarea#logEntry").val(t.entry),$("#catSpace").text(t.cat),$("#add_edit").dialog({height:575,width:800,modal:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500},buttons:{"Save Edit":function(){editFun.editlogs(t.logid)},Cancel:function(){$(this).dialog("close")}}}),$("textarea#logEntry").tinymce({browser_spellcheck:!0,forced_root_block:!1,resize:!1,menubar:"edit format view insert tools",toolbar:"undo redo | styleselect | bold italic underline | alignleft aligncenter alignright | bullist numlist | link | forecolor",plugins:["autolink link lists hr anchor pagebreak","searchreplace wordcount code insertdatetime","template paste textcolor"]})},grabedit:function(e){$.post("api/i/logs/readone",{logid:e},null,"json").done(editFun.showeditinputs)},editlogs:function(e){var t=$("input#logTitle").val();t=encodeURIComponent(t);var a=$("textarea#logEntry").val();a=encodeURIComponent(a),""!==t&&""!==a?($("#add_edit").dialog("close"),$("#messages").fadeOut(),$.post("api/i/logs/edit",{logid:e,title:t,body:a},null,"json").done(function(e){refreshFun.refreshLog(),showDialog(e.data)})):($("#messages").html('<span class="bad">Log entries must have a title, category, and entry text.</span>').fadeIn(),setTimeout(function(){$("#messages").fadeOut()},1e4))}},searchFun={check:function(e){13==e.keyCode&&searchFun.searchlog()},searchlog:function(){var e=$("input#searchterm").val(),t=$("input#datesearch").val();"Keyword"===e&&(e=""),"Date"===t&&(t=""),e=encodeURIComponent(e),$.post("api/i/logs/search",{kw:e,date:t}).done(function(e){filt=!0,refreshFun.stoprefresh(),view.makeLogView(e.data)})},filter:function(e){""===e&&(e=CategoryManage.getCatString()),e?$.post("api/i/logs/filter",{filter:e},null,"json").done(function(e){filt=!0,refreshFun.stoprefresh(),view.makeLogView(e.data)}).fail(function(e){"undefined"!=typeof e&&4===e.readyState&&404===e.status&&$("#refreshed").html("An error has occured. Please try logging out and back in.")}):alert("Please select a valid filter.")}};
"use strict";$(document).ready(function(){$("#writeMail").css("display","none"),mail.showFolder()}),$(document).on("focusin",function(t){$(t.target).closest(".mce-window").length&&t.stopImmediatePropagation()});var mail={areUnread:function(){$.getJSON("api/i/mail/mailCount",function(t){t.data.count>0&&($("#mailicon").attr("src","static/images/mail.png"),$("#mailicon").attr("alt","You have mail"),$("#mailicon").attr("title",t.data.count))}),setTimeout(function(){mail.areUnread()},1e4)},showFolder:function(){var t=$("#folder").val();switch(t){case"inbox":this.getAllMail();break;case"trash":this.getTrashCan()}},getAllMail:function(){$.getJSON("api/i/mail/getAllMail",function(t){mail.showMailList(t.data)})},getTrashCan:function(){$.getJSON("api/i/mail/getAllMail",{trash:"true"},function(t){mail.showMailList(t.data)})},showMailList:function(t){var e=t.length;$("#mailList").html("");var a=$("<table/>").addClass("mailboxCSS");a.append('<tr>                    <th width="2%">&nbsp;</th>                    <th width="15%">From</th>                    <th width="63%">Subject</th>                    <th width="20%">Date</th>            </tr>');for(var i=0;e>i;i++){var l=t[i],o='<tr>                    <td><input type="checkbox" id="check'+i+'" value='+l.id+"></td>                    <td>"+l.realname+'</td>                    <td><a href="#" onClick="mail.viewMail('+l.id+');">'+l.subject+"</a></td>                    <td>"+l.dateSent+"</td>                    </tr>";a.append("0"==l.isItRead?$(o).addClass("unread"):o)}$("#mailList").append(a)},viewMail:function(t){$.getJSON("api/i/mail/read",{mid:t},function(t){t=t.data,mail.showFolder();var e="<h2>"+t[0].subject+"</h2>                To: You<br>                From: "+t[0].realname+"<br>                Sent: "+t[0].dateSent+" "+t[0].timeSent+"<br>                <br>"+t[0].body;$("#mailDialog").html(e),$("#mailDialog").dialog({modal:!0,width:400,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500},buttons:{Ok:function(){$(this).dialog("close"),$("#mailDialog").html("")}}})})},replyToMail:function(){var t=this.getSelectedMailIds();1==t.length&&$.getJSON("api/i/mail/read",{mid:t[0]},function(t){t=t.data,$("#mailForm")[0].reset(),$("textarea#mailBody").html(t[0].body),$("#mailSubject").val("RE: "+t[0].subject),$("#toUsersId").val(t[0].fromUser),$("#toUsers").val(t[0].realname),$("#toUsers").prop("readonly",!0),mail.showWriteDialog()})},writeMailDialog:function(){$.getJSON("api/i/mail/getUserList",function(t){t=t.data,$("#mailForm")[0].reset(),$("#toUsers").prop("readonly",!1),$("textarea#mailBody").html(""),$("#toUsersId").val(""),mail.showWriteDialog();var e=[];$(t).each(function(t,a){var i=[];i.label=a.realname,i.value=a.userid,e.push(i)}),$("#toUsers").autocomplete({minLength:0,source:e,focus:function(t,e){return $("#toUsers").val(e.item.label),!1},select:function(t,e){return $("#toUsers").val(e.item.label),$("#toUsersId").val(e.item.value),!1}}).data("ui-autocomplete")._renderItem=function(t,e){return $("<li>").append("<a>"+e.label+"</a>").appendTo(t)}})},showWriteDialog:function(){$("#writeMail").dialog({height:575,width:800,modal:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500},buttons:{"Send Mail":function(){mail.sendMail()&&($(this).dialog("close"),mail.showFolder())},Cancel:function(){$(this).dialog("close")}}}),$("textarea#mailBody").tinymce({browser_spellcheck:!0,forced_root_block:!1,resize:!1,menubar:"edit format view insert tools",toolbar:"undo redo | styleselect | bold italic underline | alignleft aligncenter alignright | bullist numlist | link | forecolor",plugins:["autolink link lists hr anchor pagebreak","searchreplace wordcount code insertdatetime","template paste textcolor"]})},sendMail:function(){var t={};return t.to=$("#toUsersId").val(),t.subject=$("#mailSubject").val(),t.body=$("#mailBody").val(),""!==t.to&&""!==t.subject&&""!==t.body?(t=JSON.stringify(t),$.post("api/i/mail/send",{mail:t},function(t){t=JSON.parse(t),alert(t.data)}),!0):(alert("Error: You need a subject, body, and recipient."),!1)},deleteMail:function(){var t=this.getSelectedMailIds();if(1===t.length&&confirm("Delete Selected Mail?")){var e=!1;"trash"==$("#folder").val()&&(e=!0),$.post("api/i/mail/delete",{mid:t[0],permenant:e},function(t){t=JSON.parse(t),mail.showFolder(),alert(t.data)})}},getSelectedMailIds:function(){var t=[];return $("#mailList :checked").each(function(){t.push($(this).val())}),t}};
"use strict";var permissions={allPermissions:{createlog:!1,editlog:!1,viewlog:!1,addcat:!1,editcat:!1,deletecat:!1,adduser:!1,edituser:!1,deleteuser:!1,addgroup:!1,editgroup:!1,deletegroup:!1,viewcheesto:!1,updatecheesto:!1,admin:!1},currentPermissions:{},getList:function(){$.get("api/i/rights/getlist",{},null,"json").done(function(i){var e=$("<select/>").attr("id","groupList");e.append('<option value="0">Select:</option>');for(var s in i.data)if(i.data.hasOwnProperty(s)){var t=i.data[s];e.append('<option value="'+t.id+'">'+t.role+"</option>")}$("#groups").empty(),$("#groups").append(e)})},getPermissions:function(i){var e="undefined"!=typeof i?i:$("#groupList")[0].value;$.get("api/i/rights/getgroup",{groupid:e},null,"json").done(function(i){permissions.showPermissions(i.data)})},showPermissions:function(i){return this.currentPermissions=i,this.drawGrid(i),$("#permissionsBlock").css("display","block"),!0},savePermissions:function(){var i=this.getGrid(),e=$("#groupList").val();if(0!==e){var s=JSON.stringify(i);$.post("api/i/rights/save",{rights:s,groupid:e},null,"json").done(function(i){alert(i.data),$("#permissionsForm")[0].reset(),$("#permissionsBlock").css("display","none"),$("#groupList").val(0)})}},checkGrid:function(i){var e,s=this.allPermissions,t="#"+i;if("admin"==i)if($(t).is(":checked")){for(var o in s)s.hasOwnProperty(o)&&(s[o]=!0);this.drawGrid(s)}else e=this.currentPermissions,e[i]=!1,this.drawGrid(e);else"createlog"==i||"editlog"==i?$(t).is(":checked")&&(e=this.getGrid(),e.viewlog=!0,e[i]=!0,this.drawGrid(e)):"updatecheesto"==i&&$(t).is(":checked")&&(e=this.getGrid(),e.viewcheesto=!0,e[i]=!0,this.drawGrid(e))},goBack:function(){this.drawGrid(this.currentPermissions)},createNew:function(){$("#add-form").dialog({height:225,width:350,modal:!0,buttons:{"Create Group":function(){permissions.sendNew(),$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}}})},sendNew:function(){$.post("api/i/rights/create",{name:$("#name").val(),rights:JSON.stringify(permissions.allPermissions)},null,"json").done(function(i){$("#dialog").html(i.data),$("#dialog").dialog({modal:!0,width:400,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500},buttons:{Ok:function(){$(this).dialog("close")}}}),$("#permissionsForm")[0].reset(),$("#permissionsBlock").css("display","none"),permissions.getList()})},deleteGroup:function(){var i=$("#groupList option:selected").text();$("#dialog").html("<p>Do you really want to delete the group '"+i+"'?</p>"),$("#dialog").dialog({resizable:!1,modal:!0,buttons:{"Delete Group":function(){$(this).dialog("close");var i=$("#groupList").val();$.post("api/i/rights/delete",{groupid:i},null,"json").done(function(i){$("#dialog").html("<p>"+i.data+"</p>"),$("#dialog").dialog({modal:!0,width:400,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500},buttons:{Ok:function(){$(this).dialog("close")}}}),$("#permissionsForm")[0].reset(),$("#permissionsBlock").css("display","none"),permissions.getList()})},Cancel:function(){$(this).dialog("close")}}})},drawGrid:function(i){for(var e in i)if(i.hasOwnProperty(e)){var s="#"+e;$(s).prop("checked",i[e])}return!0},getGrid:function(){var i=JSON.parse(JSON.stringify(this.allPermissions));for(var e in i)if(i.hasOwnProperty(e)){var s="#"+e;i[e]=$(s).prop("checked")}return i},check:function(i){13==i.keyCode&&($("#add-form").dialog("close"),this.sendNew(),i.preventDefault())}};
"use strict";var newStatus=1,presence={timeoutId:0,version:0,firstgen:!0,checkstat:function(t){$.getJSON("api/i/cheesto/readall",function(e){presence.generateView(t,e),clearTimeout(presence.timeoutId),delete presence.timeoutId,presence.version=t,presence.timeoutId=setTimeout(function(){presence.checkstat(t)},3e4)})},generateView:function(t,e){if(e=e.data,!this.firstgen)return void this.updateTableOnly(t,e);var s=$("<div/>").attr("id","pt");s.append(presence.makeStatusSelect(t,e));var a,n=$("<div/>").attr("id","userStatuses");0===t?a=this.makeTableMini(e):1===t&&(a=this.makeTableFull(e)),n.append(a),s.append(n),$("#mainPresence").html(s)},updateTableOnly:function(t,e){var s;0===t?s=this.makeTableMini(e):1===t&&(s=this.makeTableFull(e)),$("#userStatuses").html(s)},makeStatusSelect:function(t,e){var s=$("<div/>").attr("id","statusSelect"),a=$("<select/>").attr("id","cstatus");a.change(function(){presence.setStatus(t)}),a.append('<option value="-1">Set Status:</option>');for(var n in e.statusOptions){var i="<option>"+e.statusOptions[n]+"</option>";a.append(i)}return s.append(a),this.firstgen=!1,s},makeTableMini:function(t){var e=$("<table/>"),s='<thead><tr>            <td width="50%">Name</td>            <td width="50%">Status</td>            </tr></thead>';e.append(s);for(var a in t)if(t.hasOwnProperty(a)&&"statusOptions"!==a){var n=t[a],i="";""!==n.message&&(i=' class="message"');var r='<tr>                    <td class="textLeft"><span title="'+n.message+'"'+i+">"+n.realname+'</span></td>                    <td><span title="'+t.statusOptions[n.status]+"&#013;Return: "+n.returntime+'" class="'+n.statusInfo.color+'">'+n.statusInfo.symbol+"</td>                    </tr>";e.append(r)}var o='<tr><td colspan="3" width="100%" class="cen">            <form><input type="button" onClick="presence.popOut();" class="linklike" value="Popout &#264;eesto"></form>            </td></tr>';return e.append(o),e},makeTableFull:function(t){var e=$("<table/>"),s='<thead><tr><td>Name</td>            <td>Message</td>            <td colspan="2">Status</td>            <td>Last Changed</td>            </tr></thead><tbody>';e.append(s);for(var a in t)if(t.hasOwnProperty(a)&&"statusOptions"!==a){var n=t[a],i="<tr>                    <td>"+n.realname+"</td>                    <td>"+n.message+'</td>                    <td class="statusi"><span class="'+n.statusInfo.color+'">'+n.statusInfo.symbol+"</span></td>";i+=0==n.status?"<td>"+t.statusOptions[n.status]+"</td>":"<td>"+t.statusOptions[n.status]+"<br>Return: "+n.returntime+"</td>",i+="<td>"+n.dmodified+"</td></tr>",e.append(i)}return e},setStatus:function(t){newStatus=$("select#cstatus").prop("selectedIndex")-1,$("select#cstatus").prop("selectedIndex",0);var e;newStatus>0?(e="",window.open("getdate","getdate","location=no,menubar=no,scrollbars=no,status=no,height=550,width=350")):0===newStatus&&(e="00:00:00",presence.sendNewStatus(0,e,t,""))},popOut:function(){window.open("presenceWindow","presencewin","location=no,menubar=no,scrollbars=no,status=no,height=500,width=950")},sendNewStatus:function(t,e,s,a){$.post("api/i/cheesto/update",{status:t,returntime:e,message:a},function(){presence.checkstat(s)})},showHideP:function(){"[ - ]"==$("#showHide").html()?($("#presence").css("minWidth",$("#mainPresence").prop("offsetWidth")+"px"),$("#mainPresence").css("display","none"),$("#showHide").html("[ + ]")):($("#presence").css("minWidth","0px"),$("#mainPresence").css("display",""),$("#showHide").html("[ - ]"))}};
"use strict";var api={resetPassword:function(){var s=$("#pass1").val(),a=$("#pass2").val();$("#pass1").val(""),$("#pass2").val(""),s===a&&""!==s?$.post("api/i/users/resetPassword",{pw:s},null,"json").done(function(s){alert(s.data),location.assign("/logout")}):alert("Passwords do not match or are empty")}};
"use strict";$(function(){api.getApiKey()});var api={getApiKey:function(){$.getJSON("api/i/keyManager/getKey",function(e){$("#apiKey").html("API Key: "+e.data.key)})},generateKey:function(){$.getJSON("api/i/keyManager/newKey",function(e){$("#apiKey").html("API Key: "+e.data.key)})},showResetPasswordForm:function(){$("#passwordResetDialog").dialog({height:300,width:450,modal:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:500},buttons:{Reset:function(){api.resetPassword()},Cancel:function(){$(this).dialog("close")}}})},resetPassword:function(){var e=$("#pass1").val(),a=$("#pass2").val();$("#pass1").val(""),$("#pass2").val(""),e===a&&""!==e?$.post("api/i/users/resetPassword",{pw:e},null,"json").done(function(e){$("#passwordResetDialog").dialog("close"),alert(e.data)}):alert("Passwords do not match or are empty")},saveLogLimit:function(){var e=$("#show_limit").val();$.post("api/i/usersettings/saveLogLimit",{limit:e},null,"json").done(function(e){alert(e.data)})},saveTheme:function(){var e=$("#userTheme").val();$.post("api/i/usersettings/saveTheme",{theme:e},null,"json").done(function(e){alert(e.data),document.location.reload(!0)})}};
"use strict";var userManager={rights:{},currentuid:null,init:function(){this.getUsersRights(),this.loadCommandList(),this.loadUserList()},getUsersRights:function(){$.ajax("api/i/rights/getUsersRights",{async:!1,dataType:"json"}).done(function(e){0===e.errorcode?userManager.rights=e.data:alert(e.status)})},loadCommandList:function(){var e=$("<select/>").attr("id","commands");e.append('<option value="">Select Command:</option>'),this.rights.adduser&&e.append('<option value="add">Add User</option>'),this.rights.deleteuser&&e.append('<option value="delete">Delete</option>'),this.rights.edituser&&(e.append('<option value="edit">Edit</option>'),e.append('<option value="reset">Reset Password</option>'),e.append('<option value="cxeesto">Change &#264;eesto</option>'),e.append('<option value="revokeKey">Revoke API Key</option>')),$("#userManageForm").prepend(e)},loadUserList:function(){$.getJSON("api/i/users/getUsersList",function(e){0===e.errorcode?userManager.displayUserList(e.data):$("#userlist").html(e.status)})},displayUserList:function(e){var t=$("<table/>"),a="<tr>		                <th>&nbsp;</th>		                <th>Real Name</th>		                <th>Username</th>		                <th>Role</th>		                <th>Date Created</th>		                <th>Theme</th>		                <th>First Login</th>		            </tr>";t.append(a);for(var s in e)if(e.hasOwnProperty(s)){var r=e[s],n='<tr>	                    	<td><input type="radio" name="uid" value="'+r.userid+'"></td>	                    	<td style="text-align: left;">'+r.realname+"</td>	                    	<td>"+r.username+"</td>	                    	<td>"+r.role+"</td>	                    	<td>"+r.datecreated+"</td>	                    	<td>"+r.theme+"</td>	                    	<td>"+r.firsttime+"</td>                    	</tr>";t.append(n)}$("#userlist").empty(),$("#userlist").append(t)},performAction:function(){var e=$("#commands").val();if($("#commands").prop("selectedIndex",0),""===e)return!1;var t=$("input[name=uid]:checked").val();return"undefined"==typeof t&&"add"!=e?!1:(this.currentuid=t,$("#dialog").empty(),void userManager.uiforms[e]())},add:function(){var e=$("#add_user").val(),t=$("#add_pass").val(),a=$("#add_fullname").val(),s=$("#add_group").val();$.post("api/i/users/create",{username:e,password:t,fullname:a,role:s},null,"json").done(function(e){console.log(e),userManager.loadUserList()})},edit:function(){var e=$("#edit_uid").val(),t=$("#edit_theme").val(),a=$("#edit_fullname").val(),s=$("#edit_group").val(),r=$("#edit_prompt").val();$.post("api/i/users/save",{uid:e,fullname:a,role:s,prompt:r,theme:t},null,"json").done(function(e){console.log(e),userManager.loadUserList()})},"delete":function(){$.post("api/i/users/delete",{uid:userManager.currentuid},null,"json").done(function(e){0===e.errorcode&&e.data===!0&&(console.log("Success"),userManager.loadUserList())})},reset:function(){var e=$("#pass1").val(),t=$("#pass2").val();$("#pass1").val(""),$("#pass2").val(""),e===t&&""!==e?$.post("api/i/users/resetPassword",{pw:e,uid:userManager.currentuid},null,"json").done(function(e){0===e.errorcode&&e.data===!0&&console.log("Success")}):alert("Passwords do not match or are empty")},cxeesto:function(){var e=$("#status_uid").val(),t=$("select#status_text").prop("selectedIndex")-1,a=$("#status_message").val(),s=$("#status_return").val();$.post("api/i/cheesto/update",{uid:e,status:t,returntime:s,message:a},null,"json").done(function(e){console.log(e),userManager.loadUserList()})},revokeKey:function(){$.post("api/i/keymanager/revokekey",{uid:userManager.currentuid},null,"json").done(function(e){0===e.errorcode&&e.data.key===!0&&console.log("Success")})}};
"use strict";userManager.uiforms={add:function(){var t=null;$.ajax("api/i/rights/getlist",{async:!1,dataType:"json"}).done(function(e){0===e.errorcode?t=e.data:alert(e.status)});var e=$("<table/>");e.append('<tr><td>Username:</td><td><input type="text" id="add_user" autocomplete="off"></td></tr>'),e.append('<tr><td>Password:</td><td><input type="password" id="add_pass"></td></tr>'),e.append('<tr><td>Real Name:</td><td><input type="text" id="add_fullname" autocomplete="off"></td></tr>');var a=$("<tr/>");a.append("<td>Role:</td>");var d=$("<td/>"),o=$("<select/>").attr("id","add_group");o.append('<option value="0">Select:</option>');for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];o.append('<option value="'+r.role+'">'+r.role+"</option>")}d.append(o),a.append(d),e.append(a),$("#dialog").append(e),this.showDialogBox("add",{title:"Add new user",buttonText1:"Add"})},edit:function(){var t=null,e=null,a=null;$.ajax("api/i/users/getuserinfo",{async:!1,dataType:"json",data:{uid:userManager.currentuid}}).done(function(e){0===e.errorcode?t=e.data:alert(e.status)}),$.ajax("api/i/rights/getlist",{async:!1,dataType:"json"}).done(function(t){0===t.errorcode?e=t.data:alert(t.status)}),$.ajax("api/i/usersettings/getthemelist",{async:!1,dataType:"json"}).done(function(t){0===t.errorcode?a=t.data:alert(t.status)});var d=$("<table/>");d.append('<tr><td>User ID:</td><td><input type="text" id="edit_uid" value="'+t.userid+'" readonly></td></tr>'),d.append('<tr><td>Real Name:</td><td><input type="text" id="edit_fullname" value="'+t.realname+'" autocomplete="off"></td></tr>');var o=$("<tr/>");o.append("<td>Role:</td>");var n=$("<td/>"),r=$("<select/>").attr("id","edit_group");for(var i in e)if(e.hasOwnProperty(i)){var p=e[i],s="";p.role==t.role&&(s="selected"),r.append('<option value="'+p.role+'" '+s+">"+p.role+"</option>")}n.append(r),o.append(n),d.append(o);var u=$("<tr/>");u.append("<td>Theme:</td>");var l=$("<td/>"),f=$("<select/>").attr("id","edit_theme");f.append(""===t.theme?'<option value="" selected>Default</option>':'<option value="">Default</option>');for(var c in a)if(a.hasOwnProperty(c)){var h=a[c],y="";h==t.theme&&(y="selected"),f.append('<option value="'+h+'" '+y+">"+h+"</option>")}l.append(f),u.append(l),d.append(u),d.append('<tr><td>Date Created:</td><td><input type="text" value="'+t.datecreated+'" readonly></td></tr>'),d.append('<tr><td>Prompt:</td><td><input type="text" id="edit_prompt" value="'+t.firsttime+'"></td></tr>'),$("#dialog").append(d),this.showDialogBox("edit",{title:"Edit user",buttonText1:"Save",height:330})},"delete":function(){$("#dialog").append("Are you sure you want to delete user X?"),this.showDialogBox("delete",{buttonText1:"Yes",buttonText2:"No"})},reset:function(){$("#dialog").append('<table>                                <tr><td>New Password:</td><td><input type="password" id="pass1"></td></tr>                                <tr><td>Repeat Password:</td><td><input type="password" id="pass2"></td></tr>                            </table>'),this.showDialogBox("reset",{buttonText1:"Reset"})},cxeesto:function(){var t=null;$.ajax("api/i/cheesto/read",{async:!1,dataType:"json",data:{uid:userManager.currentuid}}).done(function(e){0===e.errorcode?t=e:alert(e.status)});var e=$("<table/>");e.append('<tr><td>User ID:</td><td><input type="text" id="status_uid" value="'+t.data.uid+'" readonly></td></tr>'),e.append('<tr><td>Name:</td><td><input type="text" id="status_name" value="'+t.data.realname+'" readonly></td></tr>');var a=$("<tr/>");a.append("<td>Status:</td>");var d=$("<td/>"),o=$("<select/>").attr("id","status_text");o.append('<option value="-1">Set Status:</option>');for(var n in t.data.statusOptions)o.append("<option>"+t.data.statusOptions[n]+"</option>");d.append(o),a.append(d),e.append(a),e.append('<tr><td>Message:</td><td><textarea cols="30" rows="5" id="status_message">'+t.data.message+"</textarea></td></tr>"),e.append('<tr><td>Return:</td><td><input type="text" id="status_return" value="'+t.data.returntime+'"></td></tr>'),$("#dialog").append(e),$("#status_return").datetimepicker({timeFormat:"HH:mm",controlType:"select",stepMinute:10}),this.showDialogBox("cxeesto",{title:"Set User Status",height:380,width:515,buttonText1:"Save"})},revokeKey:function(){$("#dialog").append("Are you sure you want to revoke the API key for user X?"),this.showDialogBox("revokeKey",{buttonText1:"Yes",buttonText2:"No"})},showDialogBox:function(t,e){"undefined"==typeof e&&(e={}),"undefined"==typeof e.height&&(e.height=300),"undefined"==typeof e.width&&(e.width=450),"undefined"==typeof e.title&&(e.title=""),"undefined"==typeof e.buttonText1&&(e.buttonText1="Okay"),"undefined"==typeof e.buttonText2&&(e.buttonText2="Cancel");var a={};a[e.buttonText1]=function(){$(this).dialog("close"),userManager[t]()},a[e.buttonText2]=function(){$(this).dialog("close")},$("#dialog").attr("title",e.title),$("#dialog").dialog({height:e.height,width:e.width,modal:!0,show:{effect:"fade",duration:500},hide:{effect:"fade",duration:250},buttons:a})}};
//# sourceMappingURL=maps/javascript.min.js.map