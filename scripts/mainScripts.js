function refreshLog(e){var t=miscFun.microtime(true);window.XMLHttpRequest?xmlhttp=new XMLHttpRequest:xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState===4&&xmlhttp.status===200){var e=miscFun.microtime(true);var n=e-t;document.getElementById("gentime").innerHTML="This page was generated in "+n.toPrecision(3)+" sec.";document.getElementById("refreshed").innerHTML=xmlhttp.responseText;presence.checkstat(0);if(clearinput&&!editing){document.getElementById("add_edit").innerHTML=""}else{clearinput=true}if(filt){miscFun.clearfilt()}}else if(xmlhttp.readyState===4&&xmlhttp.status===404){document.getElementById("refreshed").innerHTML='<span class="bad">Error communicating with server. Please click <a href="index.php">Homepage</a></span>'}};if(e==="update"&&!filt){xmlhttp.open("POST","scripts/updatelog.php",true);xmlhttp.send()}else if(e==="filter"){cat1=document.getElementById("f_cat_1").value;if(cat1!=null&&cat1!=""&&cat1!="select"){cat2=document.getElementById("f_cat_2").value;cat3=document.getElementById("f_cat_3").value;cat4=document.getElementById("f_cat_4").value;cat5=document.getElementById("f_cat_5").value;xmlhttp.open("POST","scripts/logfilter.php",true);xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");xmlhttp.send("f_cat_1="+cat1+"&f_cat_2="+cat2+"&f_cat_3="+cat3+"&f_cat_4="+cat4+"&f_cat_5="+cat5);filt=true;refreshFun.stoprefresh()}else{alert("Please select a valid filter.")}}else if(e==="clearf"){miscFun.clearfilt();xmlhttp.open("POST","scripts/updatelog.php",true);xmlhttp.send();filt=false;document.getElementById("searchterm").value="Keyword";document.getElementById("datesearch").value="Date";refreshFun.startrefresh()}}var clearinput=true,editing=false,autore=true,filt=false,cat1="",cat2="",cat3="",cat4="",cat5="",title="",entry="",refreshinv,refreshc,secleft=120;$(document).ready(function(){$("#datesearch").datepicker();$("#datesearch").change(function(){$("#datesearch").datepicker("option","dateFormat","yy-mm-dd")})});var miscFun={microtime:function(e){var t=(new Date).getTime()/1e3;var n=parseInt(t,10);return e?t:Math.round((t-n)*1e3)/1e3+" "+n},clearaddedit:function(){document.getElementById("add_edit").innerHTML=""},clearfilt:function(){document.getElementById("f_cat_1").value="select";cat1=document.getElementById("f_cat_1");f_pop_cat_2(cat1);f_pop_cat_3(cat1);f_pop_cat_4(cat1);f_pop_cat_5(cat1)},clearval:function(e){e.value=""}};var refreshFun={startrefresh:function(){refreshLog("update");secleft=120;document.getElementById("rcounter").innerHTML="2:01";refreshc=setInterval(function(){refreshFun.rcounterc()},1e3);wherearewe=setInterval(function(){presence.checkstat(0)},3e4);autore=true;refreshFun.refreshb()},rcounterc:function(){if(secleft>119){var e=2}else if(secleft>59){var e=1}else{var e=0}var t=secleft-60*e;if(t<10||t==0){t="0"+t}document.getElementById("rcounter").innerHTML=e+":"+t;if(secleft>0){secleft=secleft-1}else{secleft=120;refreshLog("update")}},refreshb:function(){document.getElementById("refreshbutton").innerHTML=autore?'<input type="button" value="Stop Auto Refresh" onClick="refreshFun.stoprefresh();" /> Autorefresh: <span class="good">On</span> ':'<input type="button" value="Start Auto Refresh" onClick="refreshFun.startrefresh();" /> Autorefresh: <span class="bad">Off</span> '},stoprefresh:function(){clearInterval(refreshc);autore=false;document.getElementById("rcounter").innerHTML="";refreshFun.refreshb()}};var addFun={showaddinputs:function(){miscFun.clearaddedit();var e=document.createElement("form");var t=document.createElement("br");var n=document.createTextNode("Title:");e.appendChild(n);var r=document.createElement("input");r.id="add_title";r.type="text";r.size=60;e.appendChild(r);e.appendChild(t);var i=document.createTextNode("Entry:");e.appendChild(i);var s=document.createElement("textarea");s.id="add_entry";s.cols=60;s.rows=10;e.appendChild(s);var o=document.createTextNode("Category:");e.appendChild(t.cloneNode(true));e.appendChild(o);var u=document.createElement("select");u.id="cat_1";u.setAttribute("onchange","pop_cat_2(this)");var a=document.createElement("option");a.value="select";var f=document.createTextNode("Select:");a.appendChild(f);u.appendChild(a);a=document.createElement("option");a.value="Desktop";var f=document.createTextNode("Desktop");a.appendChild(f);u.appendChild(a);a=document.createElement("option");a.value="Appliances";var f=document.createTextNode("Appliances");a.appendChild(f);u.appendChild(a);a=document.createElement("option");a.value="Network";var f=document.createTextNode("Network");a.appendChild(f);u.appendChild(a);a=document.createElement("option");a.value="Servers";var f=document.createTextNode("Servers");a.appendChild(f);u.appendChild(a);a=document.createElement("option");a.value="UPS";var f=document.createTextNode("UPS");a.appendChild(f);u.appendChild(a);e.appendChild(u);u=document.createElement("select");u.id="cat_2";u.setAttribute("onchange","pop_cat_3(this)");e.appendChild(u);u=document.createElement("select");u.id="cat_3";u.setAttribute("onchange","pop_cat_4(this)");e.appendChild(u);u=document.createElement("select");u.id="cat_4";u.setAttribute("onchange","pop_cat_5(this)");e.appendChild(u);u=document.createElement("select");u.id="cat_5";e.appendChild(u);e.appendChild(t.cloneNode(true));var l=document.createElement("input");l.type="button";l.setAttribute("onclick","addFun.addlog();");l.value="Add Log";e.appendChild(l);var l=document.createElement("input");l.type="button";l.setAttribute("onclick","miscFun.clearaddedit()");l.value="Cancel";e.appendChild(l);document.getElementById("add_edit").appendChild(e);editing=true;document.body.scrollTop=document.documentElement.scrollTop=0},addlog:function(){title=document.getElementById("add_title").value;title=encodeURIComponent(title);entry=document.getElementById("add_entry").value;entry=encodeURIComponent(entry);cat1=document.getElementById("cat_1").value;cat2=document.getElementById("cat_2").value;cat3=document.getElementById("cat_3").value;cat4=document.getElementById("cat_4").value;cat5=document.getElementById("cat_5").value;window.XMLHttpRequest?xmlhttp=new XMLHttpRequest:xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState===4&&xmlhttp.status===200){document.getElementById("add_edit").innerHTML=xmlhttp.responseText;clearinput=false;editing=false;refreshLog("update");secleft=120}};xmlhttp.open("POST","scripts/add_log.php",true);xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");xmlhttp.send("cat_1="+cat1+"&cat_2="+cat2+"&cat_3="+cat3+"&cat_4="+cat4+"&cat_5="+cat5+"&add_title="+title+"&add_entry="+entry)}};var editFun={showeditinputs:function(log_info){var linfo=eval("("+log_info+")");miscFun.clearaddedit();var add_form=document.createElement("form");var loguid=document.createElement("input");loguid.type="hidden";loguid.id="loguid";loguid.value="";add_form.appendChild(loguid);var break_it=document.createElement("br");var title_text=document.createElement("input");title_text.id="edittitle";title_text.type="text";title_text.size=60;title_text.value=linfo.title;add_form.appendChild(title_text);add_form.appendChild(break_it);var entry_text=document.createElement("textarea");entry_text.id="editlog";entry_text.cols=60;entry_text.rows=10;var editing_text=document.createTextNode(linfo.entry);entry_text.appendChild(editing_text);add_form.appendChild(entry_text);add_form.appendChild(break_it.cloneNode(true));var cat_label=document.createTextNode("Category: ");add_form.appendChild(cat_label);var acat_label=document.createTextNode(linfo.cat);add_form.appendChild(acat_label);add_form.appendChild(break_it.cloneNode(true));add_form.appendChild(break_it.cloneNode(true));var edit_button=document.createElement("input");edit_button.type="button";edit_button.setAttribute("onclick","editFun.editlogs("+linfo.logid+");");edit_button.value="Save Edit";add_form.appendChild(edit_button);edit_button=document.createElement("input");edit_button.type="button";edit_button.setAttribute("onclick","miscFun.clearaddedit();");edit_button.value="Cancel";add_form.appendChild(edit_button);document.getElementById("add_edit").appendChild(add_form);editing=true;document.body.scrollTop=document.documentElement.scrollTop=0},grabedit:function(e){window.XMLHttpRequest?xmlhttp=new XMLHttpRequest:xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState===4&&xmlhttp.status===200){editFun.showeditinputs(xmlhttp.responseText)}};xmlhttp.open("POST","scripts/logeditinfo.php",true);xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");xmlhttp.send("loguid="+e)},editlogs:function(e){var t=document.getElementById("edittitle").value;t=encodeURIComponent(t);var n=document.getElementById("editlog").value;n=encodeURIComponent(n);window.XMLHttpRequest?xmlhttp=new XMLHttpRequest:xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState===4&&xmlhttp.status===200){document.getElementById("add_edit").innerHTML=xmlhttp.responseText;clearinput=false;editing=false;refreshLog("update");secleft=120}};xmlhttp.open("POST","scripts/editlogs.php",true);xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");xmlhttp.send("editlog="+n+"&edittitle="+t+"&choosen="+e)}};var searchFun={check:function(e){if(e.keyCode==13){searchFun.searchlog()}},searchlog:function(){var e=document.getElementById("searchterm").value;e=encodeURIComponent(e);var t=document.getElementById("datesearch").value;if(e!==""&&e!=="Keyword"&&e!==null&&t!==""&&t!=="Date"&&t!==null){type="both"}else if(e!==""&&e!=="Keyword"&&e!==null){type="keyw"}else if(t!==""&&t!=="Date"&&t!==null){type="dates"}else{alert("Please enter valid search criteria.");return false}window.XMLHttpRequest?xmlhttp=new XMLHttpRequest:xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState===4&&xmlhttp.status===200){miscFun.clearaddedit();filt=true;refreshFun.stoprefresh();document.getElementById("refreshed").innerHTML=xmlhttp.responseText}};xmlhttp.open("POST","scripts/logfilter.php",true);xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");xmlhttp.send("keyw="+e+"&dates="+t+"&type="+type)}}